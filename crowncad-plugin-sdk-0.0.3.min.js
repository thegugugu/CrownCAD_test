!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["CrownCAD-PluginSDK"]={})}(this,(function(e){"use strict";const t="init",n="subscribe",r="unSubscribe",i="callback",c="destroyed",a="callFunction",s="executeCommand",o="executeIncrementCommand",l="EXECUTE_IN_SPECIFIED_DOC",u="getElementsByIds",p="getElementsByFeatureId",m="getElementsByEntityId",d="getElementInAssembly",S="getElementsByInstanceId",h="getElementsByFeatureNames",y="getEntitiesByIds",I="getAllEntities",f="getEntitiesByFeatureIds",g="getEntityInAssembly",P="getEntitiesByFeatureNames",x="getEntitiesByInstanceId",v="getFeaturesByIds",C="getFeaturesByNames",T="getInstancesByIds",w="getTopInstance",B="getInstanceTree",k="messageTip",E="addHighlightElement",b="removeHighlightElement",D="clearPreview",A="clearSelection",F="CREATE_DOCUMENT",R="elementPick",N="featurePick",L="createSketch",V="exitSketch",M="editSketch",O="fullSketchCommand",q="generalCommand";class W{constructor(e,t,n){this.x=e??0,this.y=t??0,this.z=n??0}toScript(){return"new Point("+this.x+","+this.y+","+this.z+")"}}class z{constructor(e,t,n,r,i,c,a,s,o,l,u,p,m,d,S,h){return this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,c,a,s,o,l,u,p,m,d,S,h),this}set(e,t,n,r,i,c,a,s,o,l,u,p,m,d,S,h){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=r,y[1]=i,y[5]=c,y[9]=a,y[13]=s,y[2]=o,y[6]=l,y[10]=u,y[14]=p,y[3]=m,y[7]=d,y[11]=S,y[15]=h,this}setElements(e){return this.elements=e,this}toScript(){return"new Matrix4("+this.elements+")"}}function X(e){if(!e)return"[]";let t,n="[";for(let r=0;r<e.length;r++)t=e[r],"string"==typeof t?n=n+"'"+t+"'":"number"==typeof t?n+=t:t instanceof W&&(n+=t.toScript()),r!==e.length-1&&(n+=",");return n+="]",n}function Y(e){if(!e)return"{}";let t="{";for(let n of Object.keys(e)){let r=e[n];"string"==typeof r||"number"==typeof r?t+="'"+n+"': "+r+",":(r instanceof W||r instanceof z)&&(t+=r.toScript())}return t+="}",t}const j={pointCoincidence:"ConstraintType.PointCoincidence",pointXCoordinatesCoincidence:"ConstraintType.PointXCoordinatesCoincidence",pointYCoordinatesCoincidence:"ConstraintType.PointYCoordinatesCoincidence",pointOnCurve:"ConstraintType.PointOnCurve",pointOnCurveNonePar:"ConstraintType.PointOnCurveNonePar",fixedDirection:"ConstraintType.FixedDirection",fixedHorizontalDirection:"ConstraintType.FixedHorizontalDirection",fixedVerticalDirection:"ConstraintType.FixedVerticalDirection",fixedPoint:"ConstraintType.FixedPoint",fixedPointXCoordinates:"ConstraintType.FixedPointXCoordinates",fixedPointYCoordinates:"ConstraintType.FixedPointYCoordinates",parallelism:"ConstraintType.Parallelism",perpendicularity:"ConstraintType.Perpendicularity",tangency:"ConstraintType.Tangency",collineation:"ConstraintType.Collineation",equalCurves:"ConstraintType.EqualCurves",equalLength:"ConstraintType.EqualLength",equalRadius:"ConstraintType.EqualRadius",equalCurvature:"ConstraintType.EqualCurvature",offset:"ConstraintType.Offset",mirror:"ConstraintType.Mirror"};class H{static createSketch(e){if(e)return"Sketch.createSketch('"+(e.sketchName??"")+"', "+(e.datumId??8)+");\n"}static exitSketch(){return"Sketch.exitSketch();\n"}static createSketchLine(e){if(e)return"Sketch.createLine("+(e.startPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+");\n"}static createRectangle(e){if(e)return"Sketch.createRectangle("+(e.startPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+");\n"}static editSketch(e){if(e)return"Sketch.editSketch('"+(e.sketchName??"")+"');\n"}static exitEditSketch(e){if(e)return"Sketch.exitEditSketch('"+(e.sketchName??"")+"');\n"}static createReferenceLine(e){if(e)return"Sketch.createReferenceLine("+(e.startPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+");\n"}static createRectangleByCenter(e){if(e)return"Sketch.createRectangleByCenter("+(e.centerPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+");\n"}static createThreePointRectangle(e){if(e)return"Sketch.createThreePointRectangle("+(e.firstPoint?.toScript()??"new Point()")+", "+(e.secondPoint?.toScript()??"new Point()")+", "+(e.thirdPoint?.toScript()??"new Point()")+");\n"}static createParallelogram(e){if(e)return"Sketch.createParallelogram("+(e.firstPoint?.toScript()??"new Point()")+", "+(e.secondPoint?.toScript()??"new Point()")+", "+(e.thirdPoint?.toScript()??"new Point()")+");\n"}static createCircle(e){if(e)return"Sketch.createCircle("+(e.centerPoint?.toScript()??"new Point()")+", "+(e.circlePoint?.toScript()??"new Point()")+");\n"}static createCircleByThreePoint(e){if(e)return"Sketch.createCircleByThreePoint("+(e.circlePoint1?.toScript()??"new Point()")+", "+(e.circlePoint2?.toScript()??"new Point()")+", "+(e.circlePoint3?.toScript()??"new Point()")+");\n"}static createArcByCenter(e){if(e)return"Sketch.createArcByCenter("+(e.centerPoint?.toScript()??"new Point()")+", "+(e.startPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+");\n"}static createArcByThreePoint(e){if(e)return"Sketch.createArcByThreePoint("+(e.firstPoint?.toScript()??"new Point()")+", "+(e.secondPoint?.toScript()??"new Point()")+", "+(e.thirdPoint?.toScript()??"new Point()")+");\n"}static createCenterArcSlot(e){if(e)return"Sketch.createCenterArcSlot("+(e.centerPoint?.toScript()??"new Point()")+", "+(e.startPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+", "+(e.radiusPoint?.toScript()??"new Point()")+");\n"}static createThreeArcSlot(e){if(e)return"Sketch.createThreeArcSlot("+(e.firstPoint?.toScript()??"new Point()")+", "+(e.secondPoint?.toScript()??"new Point()")+", "+(e.thirdPoint?.toScript()??"new Point()")+", "+(e.radiusPoint?.toScript()??"new Point()")+");\n"}static createStraightSlot(e){if(e)return"Sketch.createStraightSlot("+(e.startPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+", "+(e.radiusPoint?.toScript()??"new Point()")+");\n"}static createCenterStraightSlot(e){if(e)return"Sketch.createCenterStraightSlot("+(e.centerPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+", "+(e.radiusPoint?.toScript()??"new Point()")+");\n"}static createEllipse(e){if(e)return"Sketch.createEllipse("+(e.centerPoint?.toScript()??"new Point()")+", "+(e.minorPoint?.toScript()??"new Point()")+", "+(e.majorPoint?.toScript()??"new Point()")+");\n"}static createEllipseArc(e){if(e)return"Sketch.createEllipseArc("+(e.centerPoint?.toScript()??"new Point()")+", "+(e.minorPoint?.toScript()??"new Point()")+", "+(e.majorPoint?.toScript()??"new Point()")+", "+(e.startAngle??0)+", "+(e.endAngle??45)+");\n"}static createRegularPolygon(e){if(e)return"Sketch.createRegularPolygon("+(e.centerPoint?.toScript()??"new Point()")+", "+(e.startPoint?.toScript()??"new Point()")+", "+(e.edgeNum??6)+", "+(e.mode??0)+");\n"}static createIntpCurve(e){if(e)return"Sketch.createIntpCurve("+(X(e.pickPoints)??"[]")+");\n"}static createPoint(e){if(e)return"Sketch.createPoint("+(e.x??0)+", "+(e.y??0)+");\n"}static setReference(e){if(e)return"Sketch.setReference("+(X(e.curveIds)??"[]")+", "+(e.reference??1)+");\n"}static createFilletCurve(e){if(e)return"Sketch.createFilletCurve("+(e.curveId1??0)+", "+(e.curveId2??0)+", "+(e.radius??10)+", "+(e.type1??4)+", "+(e.type2??4)+");\n"}static createChamferCurve(e){if(e)return"Sketch.createChamferCurve("+(e.curveId1??0)+", "+(e.curveId2??0)+", "+(e.distance1??10)+", "+(e.distance2??10)+");\n"}static createChamferCurveByAngle(e){if(e)return"Sketch.createChamferCurveByAngle("+(e.curveId1??0)+", "+(e.curveId2??0)+", "+(e.distance1??10)+", "+(e.angle??45)+");\n"}static createAutoTrimCurve(e){if(e)return"Sketch.createAutoTrimCurve("+(e.trimCurveId??0)+", "+(e.trimCurvePoint?.toScript()??"new Point()")+");\n"}static createExtendCurve(e){if(e)return"Sketch.createExtendCurve("+(e.firstCurveId??0)+", "+(e.secondCurveId??0)+");\n"}static createOffsetCurve(e){if(e)return"Sketch.createOffsetCurve("+(e.offsetOnPlane??1)+", "+(X(e.offsetCurveIds)??"[]")+", "+(e.offsetType??0)+", "+(e.offsetDistance??10)+", "+(e.bothWay??0)+");\n"}static createMirror(e){if(e)return"Sketch.createMirror("+(X(e.elementIds)??"[]")+", "+(e.axisId??0)+", "+(e.copy??1)+", "+(e.instanceId??0)+", "+(e.mirrorAxisType??0)+");\n"}static copyElements(e){if(e)return"Sketch.copyElements("+(X(e.elementIds)??"[]")+", "+(e.startPoint?.toScript()??"new Point()")+", "+(e.endPoint?.toScript()??"new Point()")+");\n"}static deleteElements(e){if(e)return"Sketch.deleteElements("+(X(e.elementIds)??"[]")+");\n"}static createDimension(e){if(e)return"Sketch.createDimension({\n  firstSnapId: "+(e.firstSnapId??0)+",\n  firstPickPnt: "+(e.firstPickPnt?.toScript()??"new Point()")+",\n  firstSnapType: "+(e.firstSnapType??7)+",\n  secondSnapId: "+(e.secondSnapId??0)+",\n  secondPickPnt: "+(e.secondPickPnt?.toScript()??"new Point()")+",\n  secondSnapType: "+(e.secondSnapType??0)+",\n  direction: "+(e.direction??3)+",\n  dimPosition: "+(e.dimPosition?.toScript()??"new Point()")+",\n  dimVal: new Variable("+(e.dimVal??10)+"),\n  changeDimVal: "+(e.changeDimVal??0)+",\n  radiusOrDiameter: "+(e.radiusOrDiameter??0)+",\n});\n"}static editDimensionValue(e){if(e)return"Sketch.editDimensionValue("+(e.dimensionId??0)+", new Variable("+(e.value??"10")+");\n"}static modifyDimensionPosition(e){if(e)return"Sketch.modifyDimensionPosition("+(e.dimensionId??0)+", "+(e.newPosition?.toScript()??"new Point()")+");\n"}static createDivision(e){if(e)return"Sketch.createDivision("+(e.curveId??0)+", "+(e.newPosition?.toScript()??"new Point()")+");\n"}static moveElements(e){if(e)return"Sketch.moveElements({\n  elementIds: "+(X(e.elementIds)??"[]")+",\n  startPnt: "+(e.startPnt?.toScript()??"new Point()")+",\n  endPnt: "+(e.endPnt?.toScript()??"new Point()")+",\n});\n"}static scaleElements(e){if(e)return"Sketch.createScaleElements({\n  elementIds: "+(X(e.elementIds)??"[]")+",\n  scalePnt: "+(e.scalePnt?.toScript()??"new Point()")+",\n  scaleRef: "+(e.scaleRef??1)+",\n  copyFlag: "+(e.copyFlag??0)+",\n  copyNum: "+(e.copyNum??1)+",\n});\n"}static rotateElements(e){if(e)return"Sketch.createRotateElements("+(X(e.elementIds)??"[]")+", "+(e.centerPoint?.toScript()??"new Point()")+", "+(e.angle??1)+");\n"}static createSketchLinearPattern(e){if(e)return"Sketch.createSketchLinearPattern({\n  elementIds: "+(X(e.elementIds)??"[]")+",\n  direction1: "+(e.direction1?.toScript()??"new Direction()")+",\n  spacing1: "+(e.spacing1??10)+",\n  reverse1: "+(e.reverse1??0)+",\n  copyNum1: "+(e.copyNum1??2)+",\n  XAngle1: "+(e.XAngle1??0)+",\n  disFlag1: "+(e.disFlag1??0)+",\n  copyNumFlag1: "+(e.copyNumFlag1??0)+",\n  direction2: "+(e.direction2?.toScript()??"new Direction()")+",\n  spacing2: "+(e.spacing2??10)+",\n  reverse2: "+(e.reverse2??0)+",\n  copyNum2: "+(e.copyNum2??2)+",\n  XAngle2: "+(e.XAngle2??90)+",\n  disFlag2: "+(e.disFlag2??0)+",\n  copyNumFlag2: "+(e.copyNumFlag2??0)+",\n  angleFlag: "+(e.angleFlag??0)+",\n  patternSeedFlag: "+(e.patternSeedFlag??0)+",\n  skipInstance: "+(X(e.skipInstance)??"[]")+",\n});\n"}static createSketchCircularPattern(e){if(e)return"Sketch.createSketchCircularPattern({\n  elementIds: "+(X(e.elementIds)??"[]")+",\n  angle: "+(e.angle??360)+",\n  instanceNum: "+(e.instanceNum??4)+",\n  reverse: "+(e.reverse??0)+",\n  equalDisFlag: "+(e.equalDisFlag??1)+",\n  labelDisFlag: "+(e.labelDisFlag??0)+",\n  labelRadiusFlag: "+(e.labelRadiusFlag??0)+",\n  labelSolidNumFlag: "+(e.labelSolidNumFlag??0)+",\n  pointX: "+(e.pointX??0)+",\n  pointY: "+(e.pointY??0)+",\n  pointId: "+(e.pointId??0)+",\n  skipInstance: "+(X(e.skipInstance)??"[]")+",\n});\n"}static createIntersectCurve(e){if(e)return"Sketch.createIntersectCurve("+(X(e.faceIds)??"[]")+");\n"}static createEquationCurve(e){if(e)return"Sketch.createEquationCurve({\n  equationType: "+(e.equationType??1)+",\n  coordinateType: "+(e.coordinateType??1)+",\n  equation1: '"+(e.equation1??"''")+"',\n  equation2: '"+(e.equation2??"''")+"',\n  startValue: "+(e.startValue??0)+",\n  endValue: "+(e.endValue??0)+",\n});\n"}static convertEdge(e){if(e)return"Sketch.convertEdge("+(X(e.edgeIds)??"[]")+");\n"}static addConstraintList(e){if(e)return"Sketch.addConstraint({\n  constraintType: "+(e.constraintType??j.pointCoincidence)+",\n  firstSnapId: "+(e.firstSnapId??0)+",\n  firstSnapType: "+(e.firstSnapType??0)+",\n  firstInstanceId: "+(e.firstInstanceId??0)+",\n  firstPickPnt: ["+(e.firstPickPnt??[0,0,0])+"],\n  secondSnapId: "+(e.secondSnapId??0)+",\n  secondSnapType: "+(e.secondSnapType??0)+",\n  secondInstanceId: "+(e.secondInstanceId??0)+",\n  secondPickPnt: ["+(e.secondPickPnt??[0,0,0])+"],\n});\n"}static createVirtualInterPoint(e){if(e)return"Sketch.virtualInterPoint({\n  curveId1: "+(e.curveId1??0)+",\n  instanceId1: "+(e.instanceId1??0)+",\n  curveId2: "+(e.curveId2??0)+",\n  instanceId2: "+(e.instanceId2??0)+",\n  pickPoint: "+(e.pickPoint?.toScript()??"new Point()")+",\n});\n"}static createCenterLine(e){if(e)return"Sketch.createCenterLine("+(e.centerPoint?.toScript()??"new Point()")+","+(e.endPnt?.toScript()??"new Point()")+","+(e.dimensionType??0)+");\n"}static createThreePointCenterRectangle(e){if(e)return"Sketch.createThreePointCenterRectangle("+(e.centerPoint?.toScript()??"new Point()")+","+(e.middlePoint?.toScript()??"new Point()")+","+(e.endPoint?.toScript()??"new Point()")+","+(e.dimConstraint??0)+");\n"}}class G{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}async executeFullSketchCommand(e){return this.parent.executeIncrementCommand(e,O)}createSketch(e){let t=H.createSketch(e);this.#e(t)}async createSketchIncrement(e){let t=H.createSketch(e);return this.#t(t,L)}exitSketch(){let e=H.exitSketch();this.#e(e)}async exitSketchIncrement(){let e=H.exitSketch();return this.#t(e,V)}editSketch(e){let t=H.editSketch(e);this.#e(t)}async editSketchIncrement(e){let t=H.editSketch(e);return this.#t(t,M)}exitEditSketch(e){let t=H.exitEditSketch(e);this.#e(t)}async exitEditSketchIncrement(e){let t=H.exitEditSketch(e);return this.#t(t,V)}createSketchLine(e){let t=H.createSketchLine(e);this.#e(t)}async createSketchLineIncrement(e){let t=H.createSketchLine(e);return this.#t(t)}createRectangle(e){let t=H.createRectangle(e);this.#e(t)}async createRectangleIncrement(e){let t=H.createRectangle(e);return this.#t(t)}createReferenceLine(e){let t=H.createReferenceLine(e);this.#e(t)}async createReferenceLineIncrement(e){let t=H.createReferenceLine(e);return this.#t(t)}createRectangleByCenter(e){let t=H.createRectangleByCenter(e);this.#e(t)}async createRectangleByCenterIncrement(e){let t=H.createRectangleByCenter(e);return this.#t(t)}createThreePointRectangle(e){let t=H.createThreePointRectangle(e);this.#e(t)}async createThreePointRectangleIncrement(e){let t=H.createThreePointRectangle(e);return this.#t(t)}createParallelogram(e){let t=H.createParallelogram(e);this.#e(t)}async createParallelogramIncrement(e){let t=H.createParallelogram(e);return this.#t(t)}createCircle(e){let t=H.createCircle(e);this.#e(t)}async createCircleIncrement(e){let t=H.createCircle(e);return this.#t(t)}createCircleByThreePoint(e){let t=H.createCircleByThreePoint(e);this.#e(t)}async createCircleByThreePointIncrement(e){let t=H.createCircleByThreePoint(e);return this.#t(t)}createArcByCenter(e){let t=H.createArcByCenter(e);this.#e(t)}async createArcByCenterIncrement(e){let t=H.createArcByCenter(e);return this.#t(t)}createArcByThreePoint(e){let t=H.createArcByThreePoint(e);this.#e(t)}async createArcByThreePointIncrement(e){let t=H.createArcByThreePoint(e);return this.#t(t)}createCenterArcSlot(e){let t=H.createCenterArcSlot(e);this.#e(t)}async createCenterArcSlotIncrement(e){let t=H.createCenterArcSlot(e);return this.#t(t)}createThreeArcSlot(e){let t=H.createThreeArcSlot(e);this.#e(t)}async createThreeArcSlotIncrement(e){let t=H.createThreeArcSlot(e);return this.#t(t)}createStraightSlot(e){let t=H.createStraightSlot(e);this.#e(t)}async createStraightSlotIncrement(e){let t=H.createStraightSlot(e);return this.#t(t)}createCenterStraightSlot(e){let t=H.createCenterStraightSlot(e);this.#e(t)}async createCenterStraightSlotIncrement(e){let t=H.createCenterStraightSlot(e);return this.#t(t)}createEllipse(e){let t=H.createEllipse(e);this.#e(t)}async createEllipseIncrement(e){let t=H.createEllipse(e);return this.#t(t)}createEllipseArc(e){let t=H.createEllipseArc(e);this.#e(t)}async createEllipseArcIncrement(e){let t=H.createEllipseArc(e);return this.#t(t)}createRegularPolygon(e){let t=H.createRegularPolygon(e);this.#e(t)}async createRegularPolygonIncrement(e){let t=H.createRegularPolygon(e);return this.#t(t)}createIntpCurve(e){let t=H.createIntpCurve(e);this.#e(t)}async createIntpCurveIncrement(e){let t=H.createIntpCurve(e);return this.#t(t)}createPoint(e){let t=H.createPoint(e);this.#e(t)}async createPointIncrement(e){let t=H.createPoint(e);return this.#t(t)}setReference(e){let t=H.setReference(e);this.#e(t)}async setReferenceIncrement(e){let t=H.setReference(e);return this.#t(t)}createFilletCurve(e){let t=H.createFilletCurve(e);this.#e(t)}async createFilletCurveIncrement(e){let t=H.createFilletCurve(e);return this.#t(t)}createChamferCurve(e){let t=H.createChamferCurve(e);this.#e(t)}async createChamferCurveIncrement(e){let t=H.createChamferCurve(e);return this.#t(t)}createChamferCurveByAngle(e){let t=H.createChamferCurveByAngle(e);this.#e(t)}async createChamferCurveByAngleIncrement(e){let t=H.createChamferCurveByAngle(e);return this.#t(t)}createAutoTrimCurve(e){let t=H.createAutoTrimCurve(e);this.#e(t)}async createAutoTrimCurveIncrement(e){let t=H.createAutoTrimCurve(e);return this.#t(t)}createExtendCurve(e){let t=H.createExtendCurve(e);this.#e(t)}async createExtendCurveIncrement(e){let t=H.createExtendCurve(e);return this.#t(t)}createOffsetCurve(e){let t=H.createOffsetCurve(e);this.#e(t)}async createOffsetCurveIncrement(e){let t=H.createOffsetCurve(e);return this.#t(t)}createMirror(e){let t=H.createMirror(e);this.#e(t)}async createMirrorIncrement(e){let t=H.createMirror(e);return this.#t(t)}copyElements(e){let t=H.copyElements(e);this.#e(t)}async copyElementsIncrement(e){let t=H.copyElements(e);return this.#t(t)}deleteElements(e){let t=H.deleteElements(e);this.#e(t)}async deleteElementsIncrement(e){let t=H.deleteElements(e);return this.#t(t)}createDimension(e){let t=H.createDimension(e);this.#e(t)}async createDimensionIncrement(e){let t=H.createDimension(e);return this.#t(t)}editDimensionValue(e){let t=H.editDimensionValue(e);this.#e(t)}async editDimensionValueIncrement(e){let t=H.editDimensionValue(e);return this.#t(t)}modifyDimensionPosition(e){let t=H.modifyDimensionPosition(e);this.#e(t)}async modifyDimensionPositionIncrement(e){let t=H.modifyDimensionPosition(e);return this.#t(t)}createDivision(e){let t=H.createDivision(e);this.#e(t)}async createDivisionIncrement(e){let t=H.createDivision(e);return this.#t(t)}moveElements(e){let t=H.moveElements(e);this.#e(t)}async moveElementsIncrement(e){let t=H.moveElements(e);return this.#t(t)}scaleElements(e){let t=H.scaleElements(e);this.#e(t)}async scaleElementsIncrement(e){let t=H.scaleElements(e);return this.#t(t)}rotateElements(e){let t=H.rotateElements(e);this.#e(t)}async rotateElementsIncrement(e){let t=H.rotateElements(e);return this.#t(t)}createSketchLinearPattern(e){let t=H.createSketchLinearPattern(e);this.#e(t)}async createSketchLinearPatternIncrement(e){let t=H.createSketchLinearPattern(e);return this.#t(t)}createSketchCircularPattern(e){let t=H.createSketchCircularPattern(e);this.#e(t)}async createSketchCircularPatternIncrement(e){let t=H.createSketchCircularPattern(e);return this.#t(t)}createIntersectCurve(e){let t=H.createIntersectCurve(e);this.#e(t)}async createIntersectCurveIncrement(e){let t=H.createIntersectCurve(e);return this.#t(t)}createEquationCurve(e){let t=H.createEquationCurve(e);this.#e(t)}async createEquationCurveIncrement(e){let t=H.createEquationCurve(e);return this.#t(t)}convertEdge(e){let t=H.convertEdge(e);this.#e(t)}async convertEdgeIncrement(e){let t=H.convertEdge(e);return this.#t(t)}addConstraintList(e){let t=H.addConstraintList(e);this.#e(t)}async addConstraintListIncrement(e){let t=H.addConstraintList(e);return this.#t(t)}createCenterLine(e){let t=H.createCenterLine(e);this.#e(t)}async createCenterLineIncrement(e){let t=H.createCenterLine(e);return this.#t(t)}createThreePointCenterRectangle(e){let t=H.createThreePointCenterRectangle(e);this.#e(t)}async createThreePointCenterRectangleIncrement(e){let t=H.createThreePointCenterRectangle(e);return this.#t(t)}}class _{static extrude(e,t=""){if(e)return"Solid.extrude('"+t+"',{\n  sketch:"+(e.sketch??0)+",\n  reverse:"+(e.reverse??0)+",\n  directionType:"+(e.directionType??0)+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  extrudeType1:"+(e.extrudeType1??0)+",\n  height1:"+(e.height1??10)+",\n  toSurface1:"+(e.toSurface1??0)+",\n  toSurface1InsId:"+(e.toSurface1InsId??"'0'")+",\n  toVertex1:"+(e.toVertex1?.toScript()??"new Point()")+",\n  reverseSurDis1:"+(e.reverseSurDis1??0)+",\n  transSurface1:"+(e.transSurface1??0)+",\n  draftType1:"+(e.draftType1??-1)+",\n  angle1:"+(e.angle1??0)+",\n  extrudeType2:"+(e.extrudeType2??-1)+",\n  height2:"+(e.height2??0)+",\n  toSurface2:"+(e.toSurface2??0)+",\n  toSurface2InsId:"+(e.toSurface2InsId??"'0'")+",\n  toVertex2:"+(e.toVertex2?.toScript()??"new Point()")+",\n  reverseSurDis2:"+(e.reverseSurDis2??0)+",\n  transSurface2:"+(e.transSurface2??0)+",\n  draftType2:"+(e.draftType2??-1)+",\n  angle2:"+(e.angle2??0)+",\n  offsetType:"+(e.offsetType??-1)+",\n  distance:"+(e.distance??0)+",\n  reverseOffset:"+(e.reverseOffset??0)+",\n  thicknessType:"+(e.thicknessType??-2)+",\n  thickness1:"+(e.thickness1??0)+",\n  thickness2:"+(e.thickness2??0)+",\n  mergeType:"+(e.mergeType??0)+",\n  mergeSolids:"+(X(e.mergeSolids)??"[]")+",\n});\n"}static extrudeCut(e,t){if(e)return"Solid.extrudeCut('"+t+"',{\n  sketch:"+(e.sketch??0)+",\n  reverse:"+(e.reverse??0)+",\n  directionType:"+(e.directionType??0)+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  extrudeType1:"+(e.extrudeType1??0)+",\n  height1:"+(e.height1??10)+",\n  toSurface1:"+(e.toSurface1??0)+",\n  toSurface1InsId:"+(e.toSurface1InsId??"'0'")+",\n  toVertex1:"+(e.toVertex1?.toScript()??"new Point()")+",\n  reverseSurDis1:"+(e.reverseSurDis1??0)+",\n  transSurface1:"+(e.transSurface1??0)+",\n  draftType1:"+(e.draftType1??-1)+",\n  angle1:"+(e.angle1??0)+",\n  extrudeType2:"+(e.extrudeType2??-1)+",\n  height2:"+(e.height2??0)+",\n  toSurface2:"+(e.toSurface2??0)+",\n  toSurface2InsId:"+(e.toSurface2InsId??"'0'")+",\n  toVertex2:"+(e.toVertex2?.toScript()??"new Point()")+",\n  reverseSurDis2:"+(e.reverseSurDis2??0)+",\n  transSurface2:"+(e.transSurface2??0)+",\n  draftType2:"+(e.draftType2??-1)+",\n  angle2:"+(e.angle2??0)+",\n  offsetType:"+(e.offsetType??-1)+",\n  distance:"+(e.distance??0)+",\n  reverseOffset:"+(e.reverseOffset??0)+",\n  thicknessType:"+(e.thicknessType??-2)+",\n  thickness1:"+(e.thickness1??0)+",\n  thickness2:"+(e.thickness2??0)+",\n  reverseToCut:"+(e.reverseToCut??0)+",\n  cutSolids:"+(X(e.cutSolids)??"[]")+",\n});\n"}static revolve(e,t){if(e)return"Solid.revolve('"+t+"',{\n  sketch:"+(e.sketch??0)+",\n  axis:"+(e.axis?.toScript()??"new Axis()")+",\n  reverse:"+(e.reverse??0)+",\n  revolveType1:"+(e.revolveType1??0)+",\n  angle1:"+(e.angle1??30)+",\n  toSurface1:"+(e.toSurface1??10)+",\n  revolveType2:"+(e.revolveType2??0)+",\n  angle2:"+(e.angle2??0)+",\n  toSurface2:"+(e.toSurface2??0)+",\n  mergeType:"+(e.mergeType??0)+",\n  mergeSolids:"+(X(e.mergeSolids)??"[]")+",\n});\n"}static revolveCut(e,t){if(e)return"Solid.revolveCut('"+t+"',{\n  sketch:"+(e.sketch??0)+",\n  axis:"+(e.axis?.toScript()??"new Axis()")+",\n  reverse:"+(e.reverse??0)+",\n  revolveType1:"+(e.revolveType1??0)+",\n  angle1:"+(e.angle1??30)+",\n  toSurface1:"+(e.toSurface1??0)+",\n  revolveType2:"+(e.revolveType2??-1)+",\n  angle2:"+(e.angle2??0)+",\n  toSurface2:"+(e.toSurface2??0)+",\n  cutSolids:"+(X(e.cutSolids)??"[]")+",\n});\n"}static sweep(e,t){if(e)return"Solid.sweep('"+t+"',{\n  sweepType:"+(e.sweepType??0)+",\n  sweepProfile:"+(e.sweepProfile??0)+",\n  loopCurveIds:"+(X(e.loopCurveIds)??"[]")+",\n  sweepPath:"+(X(e.sweepPath)??"[]")+",\n  selectChain:"+(e.selectChain??0)+",\n  profileDirection:"+(e.profileDirection??2)+",\n  sweepDirection:"+(e.sweepDirection??0)+",\n  radius:"+(e.radius??10)+",\n  mergeType:"+(e.mergeType??0)+",\n  mergeSolids:"+(X(e.mergeSolids)??"[]")+",\n});\n"}static sweepCut(e,t){if(e)return"Solid.sweepCut('"+t+"',{\n  sweepType:"+(e.sweepType??0)+",\n  sweepProfile:"+(e.sweepProfile??0)+",\n  loopCurveIds:"+(X(e.loopCurveIds)??"[]")+",\n  sweepPath:"+(X(e.sweepPath)??"[]")+",\n  profileDirection:"+(e.profileDirection??2)+",\n  sweepDirection:"+(e.sweepDirection??0)+",\n  selectChain:"+(e.selectChain??0)+",\n  radius:"+(e.radius??10)+",\n  cutSolids:"+(X(e.cutSolids)??"[]")+",\n});\n"}static loft(e,t){if(e)return"Solid.loft('"+t+"',{\n  sketchs:"+(X(e.sketchs)??"[]")+",\n  startConstraint:"+(e.startConstraint??0)+",\n  endConstraint:"+(e.endConstraint??0)+",\n  startTangent:"+(e.startTangent??"new Direction()")+",\n  endTangent:"+(e.endTangent??"new Direction()")+",\n  startMagnitude:"+(e.startMagnitude??0)+",\n  endMagnitude:"+(e.endMagnitude??0)+",\n  hasGuideCurve:"+(e.hasGuideCurve??0)+",\n  guideCurves:"+(X(e.guideCurves)??"[]")+",\n  matchPoints:"+(X(e.matchPoints)??"[]")+",\n  mergeType:"+(e.mergeType??0)+",\n  mergeSolids:"+(X(e.mergeSolids)??"[]")+",\n});\n"}static loftCut(e,t){if(e)return"Solid.loftCut('"+t+"',{\n  sketchs:"+(X(e.sketchs)??"[]")+",\n  startConstraint:"+(e.startConstraint??0)+",\n  endConstraint:"+(e.endConstraint??0)+",\n  cutType:"+(e.cutType??0)+",\n  cutSolids:"+(X(e.cutSolids)??"[]")+",\n});\n"}static createShell(e,t){if(e)return"Solid.createShell('"+t+"',{\n  removeFaces:"+(X(e.removeFaces)??"[]")+",\n  thickenSolid:"+(e.thickenSolid??0)+",\n  thickness:"+(e.thickness??10)+",\n  outward:"+(e.outward??0)+",\n  multiFaces:"+(X(e.multiFaces)??"[]")+",\n  multiThickness:"+(X(e.multiThickness)??"[]")+",\n});\n"}static thicken(e,t){if(e)return"Solid.thicken('"+t+"',{\n  thickenSurfaceId:"+(e.thickenSurfaceId??0)+",\n  thickness:"+(e.thickness??10)+",\n  outward:"+(e.outward??0)+",\n});\n"}static draftAngle(e,t){if(e)return"Solid.draftAngle('"+t+"',{\n  draftType:"+(e.draftType??0)+",\n  neutralPlane:"+(e.neutralPlane??0)+",\n  draftAngle:"+(e.draftAngle??30)+",\n  draftFaces:"+(X(e.draftFaces)??"[]")+",\n  reverse:"+(e.reverse??0)+",\n  pullDirection:"+(e.pullDirection?.toScript()??"new Direction()")+",\n  partingLines:"+(X(e.partingLines)??"[]")+",\n  otherFace:"+(e.otherFace??0)+",\n});\n"}static cutSplit(e,t){if(e)return"Solid.cutSplit('"+t+"',{\n  solidId:"+(e.solidId??0)+",\n  cutSurfaceId:"+(e.cutSurfaceId??0)+",\n});\n"}static createHole(e,t){if(e)return"Solid.createHole('"+t+"',{\n  holeFace:"+(e.holeFace??0)+",\n  holePoint:"+(e.holePoint?.toScript()??"new Point()")+",\n  holeType:"+(e.holeType??0)+",\n  endCondition:"+(e.endCondition??0)+",\n  hasEndAngle:"+(e.hasEndAngle??0)+",\n  endAngle:"+(e.endAngle??10)+",\n  depth:"+(e.depth??100)+",\n  diameter:"+(e.diameter??10)+",\n  angle1:"+(e.angle1??10)+",\n  depth1:"+(e.depth1??10)+",\n  diameter1:"+(e.diameter1??15)+",\n});\n"}static createHoles(e,t){if(e)return"Solid.createHoles('"+t+"',{\n  holeFace:"+(e.holeFace??0)+",\n  holePoint:"+(X(e.holePoint)??"[]")+",\n  holePrfId:"+(e.holePrfId??0)+",\n  holeType:"+(e.holeType??0)+",\n  diameter:"+(e.diameter??10)+",\n  hasEndAngle:"+(e.hasEndAngle??0)+",\n  endAngle:"+(e.endAngle??10)+",\n  endCondition:"+(e.endCondition??0)+",\n  depth:"+(e.depth??100)+",\n  depthToType:"+(e.depthToType??0)+",\n  toFace:"+(e.toFace??0)+",\n  offsetDis:"+(e.offsetDis??15)+",\n  toFaceType:"+(e.toFaceType??0)+",\n  diameter1:"+(e.diameter1??15)+",\n  depth1:"+(e.depth1??10)+",\n  angle1:"+(e.angle1??10)+",\n  slotDirection:"+(e.slotDirection??0)+",\n  slotDir:"+(e.slotDir?.toScript()??"new Point()")+",\n  slotLength:"+(e.slotLength??0)+",\n  arcCenterToArcCenter:"+(e.arcCenterToArcCenter??0)+",\n  slotAngle:"+(e.slotAngle??15)+",\n  slotAngleReverse:"+(e.slotAngleReverse??0)+",\n  holeForm:"+(e.holeForm??1)+",\n  threadEndType:"+(e.threadEndType??0)+",\n  displayType:"+(e.displayType??3)+",\n  showCutThread:"+(e.showCutThread??1)+",\n});\n"}static createRib(e,t){if(e)return"Solid.createRib('"+t+"',{\n  sketch:"+(e.sketch??0)+",\n  body:"+(e.body??0)+",\n  ribDirection:"+(e.ribDirection??0)+",\n  direction:"+(e.slotDir?.direction()??"new Direction()")+",\n  reverse:"+(e.reverse??0)+",\n  thicknessType:"+(e.thicknessType??0)+",\n  thickness:"+(e.thickness??10)+",\n  draftType:"+(e.draftType??-1)+",\n  angle:"+(e.angle??0)+",\n  extendType:"+(e.extendType??0)+",\n});\n"}static booleanUnion(e,t){if(e)return"Solid.booleanUnion('"+t+"',{\n  entitys:"+(X(e.entitys)??"[]")+",\n});\n"}static booleanSubtract(e,t){if(e)return"Solid.booleanSubtract('"+t+"',{\n  entityBs:"+(X(e.entityBs)??"[]")+",\n  entityA:"+(e.entityA??0)+",\n  keep:"+(e.keep??0)+",\n});\n"}static booleanIntersect(e,t){if(e)return"Solid.booleanIntersect('"+t+"',{\n  entitys:"+(X(e.entitys)??"[]")+",\n  keep:"+(e.keep??0)+",\n});\n"}static createChamfer(e,t){if(e)return"Solid.createChamfer('"+t+"',{\n  type:"+(e.type??0)+",\n  tangentPropagation:"+(e.tangentPropagation??1)+",\n  distance:"+(e.distance??0)+",\n  distance2:"+(e.distance2??0)+",\n  elements:"+(X(e.elements)??"[]")+",\n  elementTypes:"+(X(e.elementTypes)??"[]")+",\n  reverse:"+(e.reverse??0)+",\n});\n"}static createChamferByAngle(e,t){if(e)return"Solid.createChamferByAngle('"+t+"',{\n  tangentPropagation:"+(e.tangentPropagation??1)+",\n  angle:"+(e.angle??0)+",\n  distance:"+(e.distance??0)+",\n  elements:"+(X(e.elements)??"[]")+",\n  elementTypes:"+(X(e.elementTypes)??"[]")+",\n  reverse:"+(e.reverse??0)+",\n});\n"}static createFillet(e,t){if(e)return"Solid.createFillet('"+t+"',{\n  type:"+(e.type??0)+",\n  tangentPropagation:"+(e.tangentPropagation??1)+",\n  elements:"+(X(e.elements)??"[]")+",\n  radius:"+(X(e.radius)??"[]")+",\n  multiRadiusFillet:"+(e.multiRadiusFillet??1)+",\n  instanceNumber:"+(e.instanceNumber??0)+",\n  internalPoints:"+(X(e.internalPoints)??"[]")+",\n  internalRadius:"+(X(e.internalRadius)??"[]")+",\n});\n"}static mirrorSolid(e,t){if(e)return"Solid.mirrorSolid('"+t+"',{\n  baseType:"+(e.baseType??0)+",\n  body:"+(e.body??0)+",\n  features:"+(X(e.features)??"[]")+",\n  mirrorPlane:"+(e.mirrorPlane??0)+",\n  mergeSolids:"+(e.mergeSolids??0)+",\n  geometryPattern:"+(e.geometryPattern??0)+",\n});\n"}static linearPattern(e,t){if(e)return"Solid.linearPattern('"+t+"',{\n  baseType:"+(e.baseType??0)+",\n  body:"+(e.body??0)+",\n  features:"+(X(e.features)??"[]")+",\n  direction1:"+(e.direction1?.toScript()??"new Direction()")+",\n  spacing1:"+(e.spacing1??10)+",\n  instanceNum1:"+(e.instanceNum1??2)+",\n  reverse1:"+(e.reverse1??0)+",\n  direction2:"+(e.direction2?.toScript()??"new Direction()")+",\n  hasDirection2:"+(e.hasDirection2??0)+",\n  spacing2:"+(e.spacing2??10)+",\n  instanceNum2:"+(e.instanceNum2??2)+",\n  reverse2:"+(e.reverse2??0)+",\n  patternSeed:"+(e.patternSeed??0)+",\n  skipInstance:"+(e.skipInstance??0)+",\n  instancesToSkip:"+(X(e.instancesToSkip)??"[]")+",\n  geometryPattern:"+(e.geometryPattern??1)+",\n});\n"}static circularPattern(e,t){if(e)return"Solid.circularPattern('"+t+"',{\n  baseType:"+(e.baseType??0)+",\n  body:"+(e.body??0)+",\n  features:"+(X(e.features)??"[]")+",\n  axis:"+(e.axis?.toScript()??"new Axis()")+",\n  reverse:"+(e.reverse??0)+",\n  angle1:"+(e.angle1??0)+",\n  instanceNum1:"+(e.instanceNum1??2)+",\n  equalSpacing1:"+(e.equalSpacing1??1)+",\n  symmetric:"+(e.symmetric??0)+",\n  hasDirection2:"+(e.hasDirection2??0)+",\n  angle2:"+(e.angle2??120)+",\n  instanceNum2:"+(e.instanceNum2??0)+",\n  equalSpacing2:"+(e.equalSpacing2??0)+",\n  skipInstance:"+(e.skipInstance??0)+",\n  instancesToSkip:"+(X(e.instancesToSkip)??"[]")+",\n  geometryPattern:"+(e.geometryPattern??0)+",\n});\n"}static curvePattern(e,t){if(e)return"Solid.curvePattern('"+t+"',{\n  baseType:"+(e.baseType??0)+",\n  body:"+(e.body??0)+",\n  features:"+(X(e.features)??"[]")+",\n  curves:"+(X(e.curves)??"[]")+",\n  spacing:"+(e.spacing??10)+",\n  instanceNum:"+(e.instanceNum??2)+",\n  reverse:"+(e.reverse??0)+",\n  equalSpacing:"+(e.equalSpacing??1)+",\n  curveMethod:"+(e.curveMethod??0)+",\n  alignmentMethod:"+(e.alignmentMethod??0)+",\n  skipInstance:"+(e.skipInstance??0)+",\n  instancesToSkip:"+(X(e.instancesToSkip)??"[]")+",\n  curvesInsId:"+(X(e.curvesInsId)??"[]")+",\n  geometryPattern:"+(e.geometryPattern??0)+",\n});\n"}static sketchPattern(e,t){if(e)return"Solid.sketchPattern('"+t+"',{\n  baseType:"+(e.baseType??0)+",\n  body:"+(e.body??0)+",\n  features:"+(X(e.features)??"[]")+",\n  sketchId:"+(e.sketchId??0)+",\n  referenceType:"+(e.referenceType??0)+",\n  referencePoint:"+(e.referencePoint?.toScript()??"new Point()")+",\n  geometryPattern:"+(e.geometryPattern??1)+",\n  sketchInsId:"+(e.sketchInsId??1)+",\n});\n"}static createBox(e,t){if(e)return"Solid.createBox('"+t+"',{\n  positionType:"+(e.positionType??0)+",\n  positionPoint:"+(e.positionPoint?.toScript()??"new Point()")+",\n  length:"+(e.length??40)+",\n  width:"+(e.width??50)+",\n  height:"+(e.height??60)+",\n});\n"}static createCylinder(e,t){if(e)return"Solid.createCylinder('"+t+"',{\n  positionType:"+(e.positionType??0)+",\n  positionPoint:"+(e.positionPoint?.toScript()??"new Point()")+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  radius:"+(e.radius??30)+",\n  height:"+(e.height??40)+",\n});\n"}static createSphere(e,t){if(e)return"Solid.createSphere('"+t+"',{\n  center:"+(e.center?.toScript()??"new Point()")+",\n  radius:"+(e.radius??10)+",\n});\n"}static createWedge(e,t){if(e)return"Solid.createWedge('"+t+"',{\n  baseVertex:"+(e.baseVertex?.toScript()??"new Point()")+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  length:"+(e.length??20)+",\n  width:"+(e.width??20)+",\n  height:"+(e.height??20)+",\n});\n"}static createCone(e,t){if(e)return"Solid.createCone('"+t+"',{\n  center:"+(e.center?.toScript()??"new Point()")+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  radius:"+(e.radius??40)+",\n  height:"+(e.height??40)+",\n  minorRadius:"+(e.minorRadius??0)+",\n});\n"}static createPyramid(e,t){if(e)return"Solid.createPyramid('"+t+"',{\n  center:"+(e.center?.toScript()??"new Point()")+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  edgeNum:"+(e.edgeNum??8)+",\n  radius:"+(e.radius??20)+",\n  height:"+(e.height??100)+",\n});\n"}static createTorus(e,t){if(e)return"Solid.createTorus('"+t+"',{\n  center:"+(e.center?.toScript()??"new Point()")+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  innerRadius:"+(e.radius??1)+",\n  radius:"+(e.height??10)+",\n});\n"}static moveFaces(e,t){if(e)return"Solid.moveFaces('"+t+"',{\n  moveFaceIds:"+(X(e.moveFaceIds)??"[]")+",\n  X:"+(e.X??10)+",\n  Y:"+(e.Y??10)+",\n  Z:"+(e.Z??10)+",\n});\n"}static offsetFaces(e,t){if(e)return"Solid.offsetFaces('"+t+"',{\n  offsetFaceIds:"+(X(e.offsetFaceIds)??"[]")+",\n  distance:"+(e.distance??10)+",\n});\n"}static deleteFaces(e,t){if(e)return"Solid.deleteFaces('"+t+"',{\n  deleteFaceIds:"+(X(e.deleteFaceIds)??"[]")+",\n  isFix:"+(e.isFix??0)+",\n});\n"}static replaceFaces(e,t){if(e)return"Solid.replaceFaces('"+t+"',{\n  replaceFaceIds:"+(X(e.replaceFaceIds)??"[]")+",\n  targetFaceId:"+(e.targetFaceId??0)+",\n});\n"}static createCutSplit(e,t){if(e)return"Solid.createCutSplit('"+t+"',{\n  solidId:"+(e.solidId??0)+",\n  cutSurfaceId:"+(e.cutSurfaceId??0)+",\n  isInvert:"+(e.isInvert??0)+",\n});\n"}static fillPattern(e,t){if(e)return"Solid.fillPattern('"+t+"',{\n  baseType:"+(e.baseType??1)+",\n  body:"+(X(e.body)??"[]")+",\n  features:"+(X(e.features)??"[]")+",\n  fillBound:"+(X(e.fillBound)??"[]")+",\n  fillType:"+(e.fillType??0)+",\n  instDist:"+(e.instDist??10)+",\n  angle:"+(e.angle??60)+",\n  edgeDist:"+(e.edgeDist??0)+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  reverse:"+(e.reverse??0)+",\n  skipInstance:"+(e.skipInstance??0)+",\n  instSkip:"+(X(e.instSkip)??"[]")+",\n  ringInstNum:"+(e.ringInstNum??0)+",\n  polySidesNum:"+(e.polySidesNum??6)+",\n  averType:"+(e.averType??0)+",\n  geometryPattern:"+(e.geometryPattern??0)+",\n  fillBoundInsId:"+(X(e.fillBoundInsId)??"[]")+",\n});\n"}static createTransformByDistance(e,t=""){if(e)return"Solid.createTransformByDistance('"+t+"',{\n  entityIds: "+(X(e.entityIds)??"[]")+",\n  copy: "+(e.copy??1)+",\n  startPoint: "+(e.startPoint?.toScript()??"new Point()")+",\n  distance: "+(e.distance??10)+",\n  direction: "+(e.direction?.toScript()??"new Direction()")+",\n  reverse: "+(e.reverse??0)+",\n});"}static createTransformByXYZ(e,t=""){if(e)return"Solid.createTransformByXYZ('"+t+"',{\n  entityIds: "+(X(e.entityIds)??"[]")+",\n  copy: "+(e.copy??1)+",\n  startPoint: "+(e.startPoint?.toScript()??"new Point()")+",\n  endPoint: "+(e.endPoint?.toScript()??"new Point()")+",\n  reverse: "+(e.reverse??0)+",\n});"}static createTransformByRotate(e,t=""){if(e)return"Solid.createTransformByRotate('"+t+"',{\n  entityIds: "+(X(e.entityIds)??"[]")+",\n  copy: "+(e.copy??1)+",\n  startPoint: "+(e.startPoint?.toScript()??"new Point()")+",\n  angle: "+(e.angle??"10")+",\n  axis: "+(e.axis?.toScript()??"new Direction()")+",\n  reverse: "+(e.reverse??0)+",\n});"}static createTransformByCoordinateSystem(e,t=""){if(e)return"Solid.createTransformByCoordinateSystem('"+t+"',{\n  entityIds: "+(X(e.entityIds)??"[]")+",\n  copy: "+(e.copy??1)+",\n  refCoordSysId: "+(e.refCoordSysId??0)+",\n  refCoordSysInsId: '"+(e.refCoordSysInsId??"")+"',\n  tarCoordSysId: "+(e.tarCoordSysId??0)+",\n  tarCoordSysInsId: '"+(e.tarCoordSysInsId??"")+"',\n});"}}class U{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}extrude(e,t=""){let n=_.extrude(e,t);this.#e(n)}async extrudeIncrement(e,t=""){let n=_.extrude(e,t);return this.#t(n)}extrudeCut(e,t){let n=_.extrudeCut(e,t);this.#e(n)}async extrudeCutIncrement(e,t){let n=_.extrudeCut(e,t);return this.#t(n)}revolve(e,t){let n=_.revolve(e,t);this.#e(n)}async revolveIncrement(e,t){let n=_.revolve(e,t);return this.#t(n)}revolveCut(e,t){let n=_.revolveCut(e,t);this.#e(n)}async revolveCutIncrement(e,t){let n=_.revolveCut(e,t);return this.#t(n)}sweep(e,t){let n=_.sweep(e,t);this.#e(n)}async sweepIncrement(e,t){let n=_.sweep(e,t);return this.#t(n)}sweepCut(e,t){let n=_.sweepCut(e,t);this.#e(n)}async sweepCutIncrement(e,t){let n=_.sweepCut(e,t);return this.#t(n)}loft(e,t){let n=_.loft(e,t);this.#e(n)}async loftIncrement(e,t){let n=_.loft(e,t);return this.#t(n)}loftCut(e,t){let n=_.loftCut(e,t);this.#e(n)}async loftCutIncrement(e,t){let n=_.loftCut(e,t);return this.#t(n)}createShell(e,t){let n=_.createShell(e,t);this.#e(n)}async createShellIncrement(e,t){let n=_.createShell(e,t);return this.#t(n)}thicken(e,t){let n=_.thicken(e,t);this.#e(n)}async thickenIncrement(e,t){let n=_.thicken(e,t);return this.#t(n)}draftAngle(e,t){let n=_.draftAngle(e,t);this.#e(n)}async draftAngleIncrement(e,t){let n=_.draftAngle(e,t);return this.#t(n)}cutSplit(e,t){let n=_.cutSplit(e,t);this.#e(n)}async cutSplitIncrement(e,t){let n=_.cutSplit(e,t);return this.#t(n)}createHole(e,t){let n=_.createHole(e,t);this.#e(n)}async createHoleIncrement(e,t){let n=_.createHole(e,t);return this.#t(n)}createRib(e,t){let n=_.createRib(e,t);this.#e(n)}async createRibIncrement(e,t){let n=_.createRib(e,t);return this.#t(n)}booleanUnion(e,t){let n=_.booleanUnion(e,t);this.#e(n)}async booleanUnionIncrement(e,t){let n=_.booleanUnion(e,t);return this.#t(n)}booleanSubtract(e,t){let n=_.booleanSubtract(e,t);this.#e(n)}async booleanSubtractIncrement(e,t){let n=_.booleanSubtract(e,t);return this.#t(n)}booleanIntersect(e,t){let n=_.booleanIntersect(e,t);this.#e(n)}async booleanIntersectIncrement(e,t){let n=_.booleanIntersect(e,t);return this.#t(n)}createChamfer(e,t){let n=_.createChamfer(e,t);this.#e(n)}async createChamferIncrement(e,t){let n=_.createChamfer(e,t);return this.#t(n)}createChamferByAngle(e,t){let n=_.createChamferByAngle(e,t);this.#e(n)}async createChamferByAngleIncrement(e,t){let n=_.createChamferByAngle(e,t);return this.#t(n)}createFillet(e,t){let n=_.createFillet(e,t);this.#e(n)}async createFilletIncrement(e,t){let n=_.createFillet(e,t);return this.#t(n)}mirrorSolid(e,t){let n=_.mirrorSolid(e,t);this.#e(n)}async mirrorSolidIncrement(e,t){let n=_.mirrorSolid(e,t);return this.#t(n)}linearPattern(e,t){let n=_.linearPattern(e,t);this.#e(n)}async linearPatternIncrement(e,t){let n=_.linearPattern(e,t);return this.#t(n)}circularPattern(e,t){let n=_.circularPattern(e,t);this.#e(n)}async circularPatternIncrement(e,t){let n=_.circularPattern(e,t);return this.#t(n)}curvePattern(e,t){let n=_.curvePattern(e,t);this.#e(n)}async curvePatternIncrement(e,t){let n=_.curvePattern(e,t);return this.#t(n)}sketchPattern(e,t){let n=_.sketchPattern(e,t);this.#e(n)}async sketchPatternIncrement(e,t){let n=_.sketchPattern(e,t);return this.#t(n)}createBox(e,t){let n=_.createBox(e,t);this.#e(n)}async createBoxIncrement(e,t){let n=_.createBox(e,t);return this.#t(n)}createCylinder(e,t){let n=_.createCylinder(e,t);this.#e(n)}async createCylinderIncrement(e,t){let n=_.createCylinder(e,t);return this.#t(n)}createSphere(e,t){let n=_.createSphere(e,t);this.#e(n)}async createSphereIncrement(e,t){let n=_.createSphere(e,t);return this.#t(n)}createWedge(e,t){let n=_.createWedge(e,t);this.#e(n)}async createWedgeIncrement(e,t){let n=_.createWedge(e,t);return this.#t(n)}createCone(e,t){let n=_.createCone(e,t);this.#e(n)}async createConeIncrement(e,t){let n=_.createCone(e,t);return this.#t(n)}createPyramid(e,t){let n=_.createPyramid(e,t);this.#e(n)}async createPyramidIncrement(e,t){let n=_.createPyramid(e,t);return this.#t(n)}createTorus(e,t){let n=_.createTorus(e,t);this.#e(n)}async createTorusIncrement(e,t){let n=_.createTorus(e,t);return this.#t(n)}moveFaces(e,t){let n=_.moveFaces(e,t);this.#e(n)}async moveFacesIncrement(e,t){let n=_.moveFaces(e,t);return this.#t(n)}offsetFaces(e,t){let n=_.offsetFaces(e,t);this.#e(n)}async offsetFacesIncrement(e,t){let n=_.offsetFaces(e,t);return this.#t(n)}deleteFaces(e,t){let n=_.deleteFaces(e,t);this.#e(n)}async deleteFacesIncrement(e,t){let n=_.deleteFaces(e,t);return this.#t(n)}replaceFaces(e,t){let n=_.replaceFaces(e,t);this.#e(n)}async replaceFacesIncrement(e,t){let n=_.replaceFaces(e,t);return this.#t(n)}createCutSplit(e,t){let n=_.createCutSplit(e,t);this.#e(n)}async createCutSplitIncrement(e,t){let n=_.createCutSplit(e,t);return this.#t(n)}fillPattern(e,t){let n=_.fillPattern(e,t);this.#e(n)}async fillPatternIncrement(e,t){let n=_.fillPattern(e,t);return this.#t(n)}createTransformByDistance(e,t){let n=_.createTransformByDistance(e,t);this.#e(n)}async createTransformByDistanceIncrement(e,t){let n=_.createTransformByDistance(e,t);return this.#t(n)}createTransformByXYZ(e,t){let n=_.createTransformByXYZ(e,t);this.#e(n)}async createTransformByXYZIncrement(e,t){let n=_.createTransformByXYZ(e,t);return this.#t(n)}createTransformByRotate(e,t){let n=_.createTransformByRotate(e,t);this.#e(n)}async createTransformByRotateIncrement(e,t){let n=_.createTransformByRotate(e,t);return this.#t(n)}createTransformByCoordinateSystem(e,t){let n=_.createTransformByCoordinateSystem(e,t);this.#e(n)}async createTransformByCoordinateSystemIncrement(e,t){let n=_.createTransformByCoordinateSystem(e,t);return this.#t(n)}}class Z{static createHelixCurve(e,t=""){if(e)return"Curve.createHelixCurve('"+t+"',{\n  helixPlane:"+(e.helixPlane??0)+",\n  inputModel:"+(e.inputModel??0)+",\n  step:"+(e.step??10)+",\n  height:"+(e.height??50)+",\n  revolution:"+(e.revolution??5)+",\n  rotation:"+(e.rotation??0)+",\n  isTaperAngle:"+(e.isTaperAngle??0)+",\n  taperAngle:"+(e.taperAngle??0)+",\n  isEndsAngles:"+(e.isEndsAngles??0)+",\n  startAngle:"+(e.startAngle??0)+",\n  endAngle:"+(e.endAngle??0)+",\n  isInvert:"+(e.isInvert??0)+",\n});\n"}static createCompositeCurve(e,t=""){if(e)return"Curve.createCompositeCurve('"+t+"',"+(X(e.JoinEntities)??"[]")+");\n"}static createProjectCurve(e,t=""){if(e)return"Curve.createProjectCurve('"+t+"',{\n  projectionType:"+(e.projectionType??1)+",\n  sketches:"+(X(e.sketches)??"[]")+",\n  faces:"+(X(e.faces)??"[]")+",\n  reverse:"+(e.reverse??0)+",\n  directionType:"+(e.directionType??0)+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  doubleDirection:"+(e.doubleDirection??0)+",\n});\n"}static createCurveByInterpolationPoints(e,t=""){if(e)return"Curve.createCurveByInterpolationPoints('"+t+"',{\n  pickPnts:"+(X(e.pickPnts)??"[]")+",\n  isClosed:"+(e.isClosed??0)+",\n});\n"}static createSplitLine(e,t=""){if(e)return"Curve.createSplitLine('"+t+"',{\n  limitIds:"+(X(e.limitIds)??"[]")+",\n  surfaceIds:"+(X(e.surfaceIds)??"[]")+",\n  splitDirectionType:"+(e.splitDirectionType??0)+",\n  splitDirectionReverse:"+(e.splitDirectionReverse??0)+",\n});\n"}static createConnectCurve(e,t=""){if(e)return"Curve.createConnectCurve('"+t+"',{\n  lPnt:"+(e.lPnt??0)+",\n  rPnt:"+(e.rPnt??0)+",\n  lCont:"+(e.lCont??0)+",\n  rCont:"+(e.rCont??0)+",\n  lWeight:"+(e.lWeight??1)+",\n  rWeight:"+(e.rWeight??1)+",\n});\n"}static createCurveByXYZPoints(e,t=""){if(e)return"Curve.createCurveByXYZPoints('"+t+"',{\n  pickPnts:"+(X(e.points)??"[]")+",\n});\n"}}class K{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}createHelixCurve(e,t=""){let n=Z.createHelixCurve(e,t);this.#e(n)}async createHelixCurveIncrement(e,t=""){let n=Z.createHelixCurve(e,t);return this.#t(n)}createCompositeCurve(e,t=""){let n=Z.createCompositeCurve(e,t);this.#e(n)}async createCompositeCurveIncrement(e,t=""){let n=Z.createCompositeCurve(e,t);return this.#t(n)}createProjectCurve(e,t=""){let n=Z.createProjectCurve(e,t);this.#e(n)}async createProjectCurveIncrement(e,t=""){let n=Z.createProjectCurve(e,t);return this.#t(n)}createCurveByInterpolationPoints(e,t=""){let n=Z.createCurveByInterpolationPoints(e,t);this.#e(n)}async createCurveByInterpolationPointsIncrement(e,t=""){let n=Z.createCurveByInterpolationPoints(e,t);return this.#t(n)}createSplitLine(e,t=""){let n=Z.createSplitLine(e,t);this.#e(n)}async createSplitLineIncrement(e,t=""){let n=Z.createSplitLine(e,t);return this.#t(n)}createConnectCurve(e,t=""){let n=Z.createConnectCurve(e,t);this.#e(n)}async createConnectCurveIncrement(e,t=""){let n=Z.createConnectCurve(e,t);return this.#t(n)}createCurveByXYZPoints(e,t=""){let n=Z.createCurveByXYZPoints(e,t);this.#e(n)}async createCurveByXYZPointsIncrement(e,t=""){let n=Z.createCurveByXYZPoints(e,t);return this.#t(n)}}class Q{static createLine(e,t=""){if(e)return"Datum.createLine('"+t+"',{\n  referenceType:"+(e.referenceType??1)+",\n  referenceEntities:"+(X(e.referenceEntities)??"[]")+",\n  refInstanceIdList:"+(X(e.refInstanceIdList)??"[]")+",\n});\n"}static createDatumLineByPointAndSurface(e,t=""){if(e)return"Datum.createDatumLineByPointAndSurface('"+t+"',{\n  point:"+(e.point?.toScript()??"new Point()")+",\n  pointRefInstanceId:"+(e.pointRefInstanceId??0)+",\n  surfaceId:"+(e.surfaceId??0)+",\n  surfaceIdRefInstanceId:"+(e.surfaceIdRefInstanceId??0)+",\n});\n"}static createPlaneByDistance(e,t=""){if(e){let n;return n=e.faceId?"  faceId:"+e.faceId+",\n":"  planeId:"+(e.planeId??8)+",\n","Datum.createPlaneByDistance('"+t+"',{\n"+n+"  invertNormal:"+(e.invertNormal??"0")+",\n  paralDis:"+(e.paralDis??"10")+",\n  reverse:"+(e.reverse??"0")+",\n});\n"}}static createPlaneByPlanePoint(e,t=""){if(e){let n;return n=e.faceId?"  faceId:"+e.faceId+",\n":"  planeId:"+(e.planeId??8)+",\n","Datum.createPlaneByPlanePoint('"+t+"',{\n"+n+"  invertNormal:"+(e.invertNormal??0)+",\n  paralPnt:"+(e.paralPnt?.toScript()??"new Point()")+",\n});\n"}}static createPlaneByPlaneAngle(e,t=""){if(e){let n;return n=e.faceId?"  faceId:"+e.faceId+",\n":"  planeId:"+(e.planeId??8)+",\n","Datum.createPlaneByPlaneAngle('"+t+"',{\n"+n+"  invertNormal:"+(e.invertNormal??0)+",\n  additionalAxis:"+(e.additionalAxis?.toScript()??"new Axis()")+",\n  axisAngle:"+(e.axisAngle??0)+",\n  reverse:"+(e.reverse??0)+",\n});\n"}}static createPlaneByThreePoints(e,t=""){if(e)return"Datum.createPlaneByThreePoints('"+t+"',{\n  threePnts:"+(X(e.threePnts)??"[]")+",\n  invertNormal:"+(e.invertNormal??0)+",\n});\n"}static createPlaneByPointNormal(e,t=""){if(e)return"Datum.createPlaneByPointNormal('"+t+"',{\n  planeAxis:"+(e.planeAxis?.toScript()??"new Axis()")+",\n  planePnt:"+(e.planePnt?.toScript()??"new Point()")+",\n  invertNormal:"+(e.invertNormal??0)+",\n});\n"}static createPlaneByLineAngle(e,t=""){if(e)return"Datum.createPlaneByLineAngle('"+t+"',{\n  planeAxis:"+(e.planeAxis?.toScript()??"new Axis()")+",\n  planePnt:"+(e.planePnt?.toScript()??"new Point()")+",\n  invertNormal:"+(e.invertNormal??0)+",\n  axisAngle:"+(e.axisAngle??0)+",\n  reverse:"+(e.reverse??0)+",\n});\n"}static createPointByArcPoint(e,t=""){if(e)return"Datum.createPointByArcPoint('"+t+"',{\n  referenceArcId:"+(e.referenceArcId??0)+",\n});\n"}static createPointByFacePoint(e,t=""){if(e)return"Datum.createPointByFacePoint('"+t+"',{\n  referenceFaceId:"+(e.referenceFaceId??0)+",\n});\n"}static createPointByCrossPoint(e,t=""){if(e)return"Datum.createPointByCrossPoint('"+t+"',{\n  referenceElementIds:"+(X(e.referenceElementIds)??"[]")+",\n});\n"}static createPointByProjectionPoint(e,t=""){if(e)return"Datum.createPointByProjectionPoint('"+t+"',{\n  referenceFaceId:"+(e.referenceFaceId??0)+",\n  referencePoint:"+(e.referencePoint?.toScript()??"new Point()")+",\n});\n"}static createPointByPoint(e,t=""){if(e)return"Datum.createPointByPoint('"+t+"',{\n  referencePointId:"+(e.referencePointId??0)+",\n});\n"}static createPointByCurve(e,t=""){if(e)return"Datum.createPointByCurve('"+t+"',{\n  referenceEntities:"+(e.referenceEntities??0)+",\n  multiplePntsType:"+(e.multiplePntsType??0)+",\n  referenceValue:"+(e.referenceValue??10)+",\n});\n"}static createCoordinateSystemByThreePoint(e,t=""){if(e)return"Datum.createCoordinateSystemByThreePoint('"+t+"', {\n  originPoint: "+(e.originPoint?.toScript()??"new Point()")+",\n  xPoint: "+(e.xPoint?.toScript()??"new Point()")+",\n  yPoint: "+(e.yPoint?.toScript()??"new Point()")+",\n  xReverse: "+(e.xReverse??0)+",\n  yReverse: "+(e.yReverse??0)+",\n  zReverse: "+(e.zReverse??0)+",\n});"}static createCoordinateSystemByOnePointAndTwoLines(e,t=""){if(e)return"Datum.createCoordinateSystemByOnePointAndTwoLines('"+t+"', {\n  originPoint: "+(e.originPoint?.toScript()??"new Point()")+",\n  directionType: "+(e.directionType??4)+",\n  direction1: "+(e.direction1?.toScript()??"new Point()")+",\n  direction2: "+(e.direction2?.toScript()??"new Point()")+",\n  xReverse: "+(e.xReverse??0)+",\n  yReverse: "+(e.yReverse??0)+",\n  zReverse: "+(e.zReverse??0)+",\n});"}static createCoordinateSystemByThreePlanes(e,t=""){if(e)return"Datum.createCoordinateSystemByThreePlanes('"+t+"', {\n  xPlaneId: "+(e.xPlaneId??0)+",\n  xPlaneInsId: '"+(e.xPlaneInsId??0)+"',\n  yPlaneId: "+(e.yPlaneId??0)+",\n  yPlaneInsId: '"+(e.yPlaneInsId??0)+"',\n  zPlaneId: "+(e.zPlaneId??0)+",\n  zPlaneInsId: '"+(e.zPlaneInsId??0)+"',\n  xReverse: "+(e.xReverse??0)+",\n  yReverse: "+(e.yReverse??0)+",\n  zReverse: "+(e.zReverse??0)+",\n});"}static createCoordinateSystemByTrendsMatrix(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"Datum.createCoordinateSystemByTrendsMatrix('"+t+"', {\n  matrix: "+(n?"mat":"new Matrix4()")+",\n  xReverse: "+(e.xReverse??0)+",\n  yReverse: "+(e.yReverse??0)+",\n  zReverse: "+(e.zReverse??0)+",\n});"}}static createCoordinateSystemByOffset(e,t=""){if(e)return"Datum.createCoordinateSystemByOffset('"+t+"', {\n  arsId: "+(e.arsId??0)+",\n  type: "+(e.type??8)+",\n  xRotateAngle: "+(e.xRotateAngle??0)+",\n  yRotateAngle: "+(e.yRotateAngle??0)+",\n  zRotateAngle: "+(e.zRotateAngle??0)+",\n  xOffsetDistance: "+(e.xOffsetDistance??0)+",\n  yOffsetDistance: "+(e.yOffsetDistance??0)+",\n  zOffsetDistance: "+(e.zOffsetDistance??0)+",\n});"}static createCoordinateSystemByPointAndView(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"Datum.createCoordinateSystemByPointAndView('"+t+"', {\n  originPoint: "+(e.originPoint?.toScript()??"new Point()")+",\n  matrix: "+(n?"mat":"new Matrix4()")+",\n  xReverse: "+(e.xReverse??0)+",\n  yReverse: "+(e.yReverse??0)+",\n  zReverse: "+(e.zReverse??0)+",\n});"}}}class J{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}createLine(e,t=""){let n=Q.createLine(e,t);this.#e(n)}async createLineIncrement(e,t=""){let n=Q.createLine(e,t);return this.#t(n)}createPlaneByDistance(e,t=""){let n=Q.createPlaneByDistance(e,t);this.#e(n)}async createPlaneByDistanceIncrement(e,t=""){let n=Q.createPlaneByDistance(e,t);return this.#t(n)}createPlaneByPlanePoint(e,t=""){let n=Q.createPlaneByPlanePoint(e,t);this.#e(n)}async createPlaneByPlanePointIncrement(e,t=""){let n=Q.createPlaneByPlanePoint(e,t);return this.#t(n)}createPlaneByPlaneAngle(e,t=""){let n=Q.createPlaneByPlaneAngle(e,t);this.#e(n)}async createPlaneByPlaneAngleIncrement(e,t=""){let n=Q.createPlaneByPlaneAngle(e,t);return this.#t(n)}createPlaneByThreePoints(e,t=""){let n=Q.createPlaneByThreePoints(e,t);this.#e(n)}async createPlaneByThreePointsIncrement(e,t=""){let n=Q.createPlaneByThreePoints(e,t);return this.#t(n)}createPlaneByPointNormal(e,t=""){let n=Q.createPlaneByPointNormal(e,t);this.#e(n)}async createPlaneByPointNormalIncrement(e,t=""){let n=Q.createPlaneByPointNormal(e,t);return this.#t(n)}createPlaneByLineAngle(e,t=""){let n=Q.createPlaneByLineAngle(e,t);this.#e(n)}async createPlaneByLineAngleIncrement(e,t=""){let n=Q.createPlaneByLineAngle(e,t);return this.#t(n)}createPointByArcPoint(e,t=""){let n=Q.createPointByArcPoint(e,t);this.#e(n)}async createPointByArcPointIncrement(e,t=""){let n=Q.createPointByArcPoint(e,t);return this.#t(n)}createPointByFacePoint(e,t=""){let n=Q.createPointByFacePoint(e,t);this.#e(n)}async createPointByFacePointIncrement(e,t=""){let n=Q.createPointByFacePoint(e,t);return this.#t(n)}createPointByCrossPoint(e,t=""){let n=Q.createPointByCrossPoint(e,t);this.#e(n)}async createPointByCrossPointIncrement(e,t=""){let n=Q.createPointByCrossPoint(e,t);return this.#t(n)}createPointByProjectionPoint(e,t=""){let n=Q.createPointByProjectionPoint(e,t);this.#e(n)}async createPointByProjectionPointIncrement(e,t=""){let n=Q.createPointByProjectionPoint(e,t);return this.#t(n)}createPointByPoint(e,t=""){let n=Q.createPointByPoint(e,t);this.#e(n)}async createPointByPointIncrement(e,t=""){let n=Q.createPointByPoint(e,t);return this.#t(n)}createPointByCurve(e,t=""){let n=Q.createPointByCurve(e,t);this.#e(n)}async createPointByCurveIncrement(e,t=""){let n=Q.createPointByCurve(e,t);return this.#t(n)}createCoordinateSystemByThreePoint(e,t=""){let n=Q.createCoordinateSystemByThreePoint(e,t);this.#e(n)}async createCoordinateSystemByThreePointIncrement(e,t=""){let n=Q.createCoordinateSystemByThreePoint(e,t);return this.#t(n)}createCoordinateSystemByOnePointAndTwoLines(e,t=""){let n=Q.createCoordinateSystemByOnePointAndTwoLines(e,t);this.#e(n)}async createCoordinateSystemByOnePointAndTwoLinesIncrement(e,t=""){let n=Q.createCoordinateSystemByOnePointAndTwoLines(e,t);return this.#t(n)}createCoordinateSystemByThreePlanes(e,t=""){let n=Q.createCoordinateSystemByThreePlanes(e,t);this.#e(n)}async createCoordinateSystemByThreePlanesIncrement(e,t=""){let n=Q.createCoordinateSystemByThreePlanes(e,t);return this.#t(n)}createCoordinateSystemByTrendsMatrix(e,t=""){let n=Q.createCoordinateSystemByTrendsMatrix(e,t);this.#e(n)}async createCoordinateSystemByTrendsMatrixIncrement(e,t=""){let n=Q.createCoordinateSystemByTrendsMatrix(e,t);return this.#t(n)}createCoordinateSystemByOffset(e,t=""){let n=Q.createCoordinateSystemByOffset(e,t);this.#e(n)}async createCoordinateSystemByOffsetIncrement(e,t=""){let n=Q.createCoordinateSystemByOffset(e,t);return this.#t(n)}createCoordinateSystemByPointAndView(e,t=""){let n=Q.createCoordinateSystemByPointAndView(e,t);this.#e(n)}async createCoordinateSystemByPointAndViewIncrement(e,t=""){let n=Q.createCoordinateSystemByPointAndView(e,t);return this.#t(n)}}class ${static getEntityVolume(e){if(e)return"Evaluate.getEntityVolume("+(e.entityId??0)+");\n"}static getEntityArea(e){if(e)return"Evaluate.getEntityArea("+(e.entityId??0)+");\n"}static getEntityCentroid(e){if(e)return"Evaluate.getEntityCentroid("+(e.entityId??0)+");\n"}static getEntityMassProperties(e){if(e)return"Evaluate.getEntityMassProperties("+(e.entityId??0)+");\n"}static getInstanceMassProperties(e){if(e)return"Evaluate.getInstanceMassProperties('"+(e.instanceId??"")+"');\n"}static checkCollision(e){if(e)return"Evaluate.checkCollision("+(X(e.instanceId)??"[]")+","+(e.distance??0)+");\n"}static getMeasureInfo(e){if(e)return"Evaluate.getMeasureInfo("+(X(e.geomId)??"[]")+","+(X(e.instanceId)??"[]")+");\n"}static getBoundingBox(e){if(e)return"Evaluate.getBoundingBox({\n  boundType: "+(e.boundType??0)+",\n  entityIds: "+(X(e.entityIds)??"[]")+",\n  instanceIds: "+(X(e.instanceIds)??"[]")+",\n  defPlaneId: "+(e.defPlaneId??0)+",\n  defPlaneInstanceId: '"+(e.defPlaneInstanceId??"")+"',\n  includeHide: "+(e.includeHide??0)+",\n  includeSurface: "+(e.includeSurface??0)+",\n  includeComp: "+(e.includeComp??0)+",\n});"}}class ee{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}async getEntityVolumeIncrement(e){let t=$.getEntityVolume(e);return this.#t(t)}async getEntityAreaIncrement(e){let t=$.getEntityArea(e);return this.#t(t)}async getEntityCentroidIncrement(e){let t=$.getEntityCentroid(e);return this.#t(t)}async getEntityMassPropertiesIncrement(e){let t=$.getEntityMassProperties(e);return this.#t(t)}async getInstanceMassPropertiesIncrement(e){let t=$.getInstanceMassProperties(e);return this.#t(t)}async checkCollisionIncrement(e){let t=$.checkCollision(e);return this.#t(t)}async getMeasureInfoIncrement(e){let t=$.getMeasureInfo(e);return this.#t(t)}async getBoundingBoxIncrement(e){let t=$.getBoundingBox(e);return this.#t(t)}}class te{static extrudeSurface(e,t=""){if(e)return"Surface.extrudeSurface('"+t+"',{\n  curveIds:"+(X(e.curveIds)??"[]")+",\n  reverse:"+(e.reverse??0)+",\n  directionType:"+(e.directionType??0)+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  extrudeType1:"+(e.extrudeType1??0)+",\n  height1:"+(e.height1??10)+",\n  toSurface1:"+(e.toSurface1??0)+",\n  draftType1:"+(e.draftType1??-1)+",\n  angle1:"+(e.angle1??0)+",\n  extrudeType2:"+(e.extrudeType2??-1)+",\n  height2:"+(e.height2??0)+",\n  toSurface2:"+(e.toSurface2??0)+",\n  draftType2:"+(e.draftType2??-1)+",\n  angle2:"+(e.angle2??0)+",\n  offsetType:"+(e.offsetType??-1)+",\n  distance:"+(e.distance??0)+",\n  reverseOffset:"+(e.reverseOffset??0)+",\n});\n"}static revolveSurface(e,t=""){if(e)return"Surface.revolveSurface('"+t+"',{\n  contours:"+(X(e.contours)??"[]")+",\n  axis:"+(e.axis?.toScript()??"new Axis()")+",\n  reverse:"+(e.reverse??0)+",\n  revolveType1:"+(e.revolveType1??0)+",\n  angle1:"+(e.angle1??120)+",\n  ToSurface1:"+(e.ToSurface1??0)+",\n  revolveType2:"+(e.revolveType2??-1)+",\n  angle2:"+(e.angle2??120)+",\n  ToSurface2:"+(e.ToSurface2??0)+",\n});\n"}static offsetSurface(e,t=""){if(e)return"Surface.offsetSurface('"+t+"',{\n  surfaceIds:"+(X(e.surfaceIds)??"[]")+",\n  distance:"+(e.distance??10)+",\n  modeType:"+(e.modeType??0)+",\n  reverse:"+(e.reverse??0)+",\n});\n"}static sweepSurface(e,t=""){if(e)return"Surface.sweepSurface('"+t+"',{\n  sweepType:"+(e.sweepType??0)+",\n  sweepProfile:"+(e.sweepProfile??0)+",\n  sweepPath:"+(X(e.sweepPath)??"[]")+",\n  profileDirection:"+(e.profileDirection??2)+",\n  sweepDirection:"+(e.sweepDirection??0)+",\n  diameter:"+(e.diameter??0)+",\n});\n"}static deleteSurface(e,t=""){if(e)return"Surface.deleteSurface('"+t+"', "+(X(e.surfaceIds)??"[]")+");\n"}static planeSurface(e,t=""){if(e)return"Surface.planeSurface('"+t+"', "+(X(e.boundingEntities)??"[]")+");\n"}static trimSurface(e,t=""){if(e)return"Surface.trimSurface('"+t+"',{\n  limitIds:"+(X(e.limitIds)??"[]")+",\n  surfaceIds:"+(X(e.surfaceIds)??"[]")+",\n  keepMode:"+(e.keepMode??0)+",\n  keepTags:"+(X(e.keepTags)??"[]")+",\n  oldSurfaceIds:"+(X(e.oldSurfaceIds)??"[]")+",\n  newSurfaceIds:"+(X(e.newSurfaceIds)??"[]")+",\n});\n"}static extendSurface(e,t=""){if(e)return"Surface.extendSurface('"+t+"',{\n  extendType:"+(e.extendType??0)+",\n  extendSrfIds:"+(X(e.extendSrfIds)??"[]")+",\n  U0:"+(e.U0??0)+",\n  U1:"+(e.U1??1)+",\n  V0:"+(e.V0??0)+",\n  V1:"+(e.V1??1)+",\n  extendBoundIds:"+(X(e.extendBoundIds)??"[]")+",\n  length:"+(e.length??10)+",\n});\n"}static fillSurface(e,t=""){if(e)return"Surface.fillSurface('"+t+"',{\n  boundaryCurveIds:"+(X(e.boundaryCurveIds)??"[]")+",\n  alternateFace:"+(e.alternateFace??0)+",\n  reverseSurface:"+(e.reverseSurface??0)+",\n});\n"}static boundarySurface(e,t=""){if(e)return"Surface.boundarySurface('"+t+"',{\n  selectMode:"+(e.selectMode??0)+",\n  primaryCurveIds:"+(X(e.primaryCurveIds)??"[]")+",\n  secondaryCurveIds:"+(X(e.secondaryCurveIds)??"[]")+",\n});\n"}static loftSurface(e,t=""){if(e)return"Surface.loftSurface('"+t+"',{\n  profiles:"+(X(e.profiles)??"[]")+",\n  hasGuideCurve:"+(e.hasGuideCurve??0)+",\n  guideCurves:"+(X(e.guideCurves)??"[]")+",\n});\n"}static knitSurface(e,t=""){if(e)return"Surface.knitSurface('"+t+"',{\n  surfaces:"+(X(e.surfaces)??"[]")+",\n  controlGap:"+(e.controlGap??0)+",\n  tolerance:"+(e.tolerance??.001)+",\n});\n"}static ruledSurface(e,t=""){if(e)return"Surface.ruledSurface('"+t+"',{\n  edgeCurveIds:"+(X(e.edgeCurveIds)??"[]")+",\n  alternateFaces:"+(X(e.alternateFaces)??"[]")+",\n  ruledSurfaceType:"+(e.ruledSurfaceType??0)+",\n  distance:"+(e.distance??50)+",\n  trimAndKnit:"+(e.trimAndKnit??1)+",\n  connectingSurface:"+(e.connectingSurface??1)+",\n  direction:"+(e.direction?.toScript()??"new Direction()")+",\n  angle:"+(e.angle??1)+",\n  coordinateInput:"+(e.coordinateInput?.toScript()??"new Point()")+",\n  scanType:"+(e.scanType??0)+",\n});\n"}static radiateSurface(e,t=""){if(e)return"Surface.radiateSurface('"+t+"',{\n  directionFaceId:"+(e.directionFaceId??0)+",\n  radiateLines:"+(X(e.radiateLines)??"[]")+",\n  length:"+(e.length??10)+",\n  reverse:"+(e.reverse??0)+",\n  extend:"+(e.extend??0)+",\n});\n"}}class ne{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}extrudeSurface(e,t=""){let n=te.extrudeSurface(e,t);this.#e(n)}async extrudeSurfaceIncrement(e,t=""){let n=te.extrudeSurface(e,t);return this.#t(n)}revolveSurface(e,t=""){let n=te.revolveSurface(e,t);this.#e(n)}async revolveSurfaceIncrement(e,t=""){let n=te.revolveSurface(e,t);return this.#t(n)}offsetSurface(e,t=""){let n=te.offsetSurface(e,t);this.#e(n)}async offsetSurfaceIncrement(e,t=""){let n=te.offsetSurface(e,t);return this.#t(n)}sweepSurface(e,t=""){let n=te.sweepSurface(e,t);this.#e(n)}async sweepSurfaceIncrement(e,t=""){let n=te.sweepSurface(e,t);return this.#t(n)}deleteSurface(e,t=""){let n=te.deleteSurface(e,t);this.#e(n)}async deleteSurfaceIncrement(e,t=""){let n=te.deleteSurface(e,t);return this.#t(n)}planeSurface(e,t=""){let n=te.planeSurface(e,t);this.#e(n)}async planeSurfaceIncrement(e,t=""){let n=te.planeSurface(e,t);return this.#t(n)}trimSurface(e,t=""){let n=te.trimSurface(e,t);this.#e(n)}async trimSurfaceIncrement(e,t=""){let n=te.trimSurface(e,t);return this.#t(n)}extendSurface(e,t=""){let n=te.extendSurface(e,t);this.#e(n)}async extendSurfaceIncrement(e,t=""){let n=te.extendSurface(e,t);return this.#t(n)}fillSurface(e,t=""){let n=te.fillSurface(e,t);this.#e(n)}async fillSurfaceIncrement(e,t=""){let n=te.fillSurface(e,t);return this.#t(n)}boundarySurface(e,t=""){let n=te.boundarySurface(e,t);this.#e(n)}async boundarySurfaceIncrement(e,t=""){let n=te.boundarySurface(e,t);return this.#t(n)}loftSurface(e,t=""){let n=te.loftSurface(e,t);this.#e(n)}async loftSurfaceIncrement(e,t=""){let n=te.loftSurface(e,t);return this.#t(n)}knitSurface(e,t=""){let n=te.knitSurface(e,t);this.#e(n)}async knitSurfaceIncrement(e,t=""){let n=te.knitSurface(e,t);return this.#t(n)}ruledSurface(e,t=""){let n=te.ruledSurface(e,t);this.#e(n)}async ruledSurfaceIncrement(e,t=""){let n=te.ruledSurface(e,t);return this.#t(n)}radiateSurface(e,t=""){let n=te.radiateSurface(e,t);this.#e(n)}async radiateSurfaceIncrement(e,t=""){let n=te.radiateSurface(e,t);return this.#t(n)}}class re{static insertComponent(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"Assembly.insertComponent('"+t+"',{\n  docName:'"+(e.docName??"'Part 1'")+"',\n"+(n?"  matrix4:"+(n?"mat":"new Matrix4()")+",\n":"  position:"+(e.position?.toScript()??"new Point()")+",\n")+"  boxCenter:"+(e.boxCenter??0)+",\n  projectId:"+(e.projectId??"''")+",\n});\n"}}static insertParametricPart(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"Assembly.insertParametricPart('"+t+"',{\n  templateName:'"+(e.templateName??"'template 1'")+"',\n  parameters:"+(Y(e.parameters)??"{}")+",\n"+(n?"  matrix4:"+(n?"mat":"new Matrix4()")+",\n  position:"+(e.position?.toScript()??"new Point()")+",\n":"  position:"+(e.position?.toScript()??"new Point()")+",\n")+"  boxCenter:"+(e.boxCenter??0)+",\n});\n"}}static insertComponentFromExecProgram(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"Assembly.insertComponentFromExecProgram('"+t+"',{\n  programName:'"+(e.programName??"'program name'")+"',\n  arguments:"+(Y(e.arguments)??"{}")+",\n"+(n?"  matrix4:"+(n?"mat":"new Matrix4()")+",\n  position:"+(e.position?.toScript()??"new Point()")+",\n":"  position:"+(e.position?.toScript()??"new Point()")+",\n")+"  boxCenter:"+(e.boxCenter??0)+",\n});\n"}}static replaceComponent(e){if(e)return"Assembly.replaceComponent('"+(e.instanceId??"")+"','"+(e.docName??"Part 1")+"',"+(e.projectId??"''")+");\n"}static replaceComponentFromExecProgram(e){if(e)return"Assembly.replaceComponentFromExecProgram('"+(e.instanceId??"")+"','"+(e.programName??"programName")+"',"+(Y(e.arguments)??"{}")+");\n"}static createMating(e,t=""){if(e)return"Assembly.createMating('"+t+"',{\n  moveInstanceId:'"+(e.moveInstanceId??"0")+"',\n  moveElementId:"+(e.moveElementId??0)+",\n  refInstanceId:'"+(e.refInstanceId??"0")+"',\n  refElementId:"+(e.refElementId??0)+",\n  matingType:"+(e.matingType??0)+",\n  alignType:"+(e.alignType??0)+",\n  offsetValue:"+(e.offsetValue??0)+",\n});\n"}static createGearMating(e,t=""){if(e)return"Assembly.createGearMating('"+t+"',{\n  moveInstanceId:'"+(e.moveInstanceId??"0")+"',\n  moveElementId:"+(e.moveElementId??0)+",\n  refInstanceId:'"+(e.refInstanceId??"0")+"',\n  refElementId:"+(e.refElementId??0)+",\n  gearValue1:"+(e.gearValue1??0)+",\n  gearValue2:"+(e.gearValue2??0)+",\n  reverse:"+(e.reverse??0)+",\n});\n"}static createSlotMating(e,t=""){if(e)return"Assembly.createSlotMating ('"+t+"',{\n  moveInstanceId:'"+(e.moveInstanceId??"0")+"',\n  moveElementId:"+(e.moveElementId??0)+",\n  refInstanceId:'"+(e.refInstanceId??"0")+"',\n  refElementId:"+(e.refElementId??0)+",\n  constraintType:"+(e.constraintType??0)+",\n  offsetValue:"+(e.offsetValue??0)+",\n  reverse:"+(e.reverse??0)+",\n  alignType:"+(e.alignType??0)+",\n});\n"}static linearPattern(e,t=""){if(e){let n="  component:'"+(e.component??"")+"',\n";return e.component instanceof Array&&(n="  component:"+(X(e.component)??"[]")+",\n"),"Assembly.linearPattern('"+t+"',{\n"+n+"  direction1:"+(e.direction1?.toScript()??"new Direction()")+",\n  reverse1:"+(e.reverse1??0)+",\n  spacing1:"+(e.spacing1??10)+",\n  instanceNum1:"+(e.instanceNum1??2)+",\n  hasDirection2:"+(e.hasDirection2??0)+",\n  direction2:"+(e.direction2?.toScript()??"new Direction()")+",\n  reverse2:"+(e.reverse2??0)+",\n  spacing2:"+(e.spacing2??10)+",\n  instanceNum2:"+(e.instanceNum2??0)+",\n  patternSeed:"+(e.patternSeed??0)+",\n  skipInstance:"+(e.skipInstance??0)+",\n  instancesToSkip:"+(X(e.instancesToSkip)??"[]")+",\n});\n"}}static circularPattern(e,t=""){if(e){let n="  component:'"+(e.component??"")+"',\n";return e.component instanceof Array&&(n="  component:"+(X(e.component)??"[]")+",\n"),"Assembly.circularPattern('"+t+"',{\n"+n+"  axis:"+(e.axis?.toScript()??"new Axis()")+",\n  reverse:"+(e.reverse??0)+",\n  angle1:"+(e.angle1??0)+",\n  instanceNum1:"+(e.instanceNum1??2)+",\n  equalSpacing1:"+(e.equalSpacing1??1)+",\n  symmetric:"+(e.symmetric??0)+",\n  hasDirection2:"+(e.hasDirection2??0)+",\n  angle2:"+(e.angle2??120)+",\n  instanceNum2:"+(e.instanceNum2??0)+",\n  equalSpacing2:"+(e.equalSpacing2??0)+",\n  skipInstance:"+(e.skipInstance??0)+",\n  instancesToSkip:"+(X(e.instancesToSkip)??"[]")+",\n});\n"}}static curvePattern(e,t=""){if(e){let n="  component:'"+(e.component??"")+"',\n";return e.component instanceof Array&&(n="  component:"+(X(e.component)??"[]")+",\n"),"Assembly.curvePattern('"+t+"',{\n"+n+"  curves:"+(X(e.curves)??"[]")+",\n  curveInstances:"+(X(e.curveInstances)??"[]")+",\n  reverse:"+(e.reverse??0)+",\n  spacing:"+(e.spacing??0)+",\n  instanceNum:"+(e.instanceNum??2)+",\n  equalSpacing:"+(e.equalSpacing??1)+",\n  curveMethod:"+(e.curveMethod??0)+",\n  alignmentMethod:"+(e.alignmentMethod??0)+",\n  skipInstance:"+(e.skipInstance??0)+",\n  instancesToSkip:"+(X(e.instancesToSkip)??"[]")+",\n});\n"}}static sketchPattern(e,t=""){if(e){let n="  component:'"+(e.component??"")+"',\n";return e.component instanceof Array&&(n="  component:"+(X(e.component)??"[]")+",\n"),"Assembly.sketchPattern('"+t+"',{\n"+n+"  sketchId:"+(e.sketchId??0)+",\n  referenceType:"+(e.referenceType??0)+",\n  referencePoint:"+(e.referencePoint?.toScript()??"new Point()")+",\n});\n"}}static fixInstance(e){if(e)return"Assembly.fixInstance('"+(e.instanceId??"0")+"',"+ +(e.status??0)+");\n"}static moveInstance(e){if(e)return"Assembly.moveInstance({\n  instanceId:"+(X(e.instanceId)??"[]")+",\n  startPos:"+(e.startPos?.toScript()??"new Point()")+",\n  endPos:"+(e.endPos?.toScript()??"new Point()")+",\n  moveType:"+(e.moveType??0)+",\n  checkType:"+(e.checkType??0)+",\n  moveDir:"+(e.moveDir?.toScript()??"new Direction()")+",\n  varX:"+(e.varX??0)+",\n  varY:"+(e.varY??0)+",\n  varZ:"+(e.varZ??0)+",\n  checkRange:"+(X(e.checkRange)??"[]")+",\n});\n"}static rotateInstance(e){if(e)return"Assembly.rotateInstance({\n  instanceId:"+(X(e.instanceId)??"[]")+",\n  rotateType:"+(e.rotateType??0)+",\n  checkType:"+(e.checkType??0)+",\n  axialDir:"+(e.axialDir?.toScript()??"new Point()")+",\n  rotateAxis:"+(e.rotateAxis?.toScript()??"new Axis()")+",\n  angleVal:"+(e.angleVal??0)+",\n  angleValX:"+(e.angleValX??0)+",\n  angleValY:"+(e.angleValY??0)+",\n  angleValZ:"+(e.angleValZ??0)+",\n  checkRange:"+(X(e.checkRange)??"[]")+",\n});\n"}static mirrorInstances(e,t=""){if(e)return"Assembly.mirrorInstances('"+t+"',{\n  instanceId:"+(X(e.instanceId)??"[]")+",\n  mirrorPlaneId:"+(e.mirrorPlaneId??8)+",\n  mirrorPlaneInstanceId:'"+(e.mirrorPlaneInstanceId??"")+"',\n});\n"}static patternDrivePattern(e,t=""){if(e)return"Assembly.patternDrivePattern('"+t+"',{\n  instanceId:"+(X(e.instanceId)??"[]")+",\n  driveFeatureId:"+(e.driveFeatureId??0)+",\n  driveInstance:'"+(e.driveInstance??"")+"',\n  skipInstance:"+(e.skipInstance??0)+",\n  instanceToSkip:"+(X(e.instanceToSkip)??"[]")+",\n  modOriPosition:"+(e.modOriPosition??0)+",\n  orgPositionInsId:'"+(e.orgPositionInsId??"")+"',\n});\n"}}class ie{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}insertComponent(e,t=""){let n=re.insertComponent(e,t);this.#e(n)}async insertComponentIncrement(e,t=""){let n=re.insertComponent(e,t);return this.#t(n)}insertParametricPart(e,t=""){let n=re.insertParametricPart(e,t);this.#e(n)}async insertParametricPartIncrement(e,t=""){let n=re.insertParametricPart(e,t);return this.#t(n)}insertComponentFromExecProgram(e,t=""){let n=re.insertComponentFromExecProgram(e,t);this.#e(n)}async insertComponentFromExecProgramIncrement(e,t=""){let n=re.insertComponentFromExecProgram(e,t);return this.#t(n)}replaceComponent(e){let t=re.replaceComponent(e);this.#e(t)}async replaceComponentIncrement(e){let t=re.replaceComponent(e);return this.#t(t)}replaceComponentFromExecProgram(e){let t=re.replaceComponentFromExecProgram(e);this.#e(t)}async replaceComponentFromExecProgramIncrement(e){let t=re.replaceComponentFromExecProgram(e);return this.#t(t)}createMating(e,t=""){let n=re.createMating(e,t);this.#e(n)}async createMatingIncrement(e,t=""){let n=re.createMating(e,t);return this.#t(n)}linearPattern(e,t=""){let n=re.linearPattern(e,t);this.#e(n)}async linearPatternIncrement(e,t=""){let n=re.linearPattern(e,t);return this.#t(n)}circularPattern(e,t=""){let n=re.circularPattern(e,t);this.#e(n)}async circularPatternIncrement(e,t=""){let n=re.circularPattern(e,t);return this.#t(n)}curvePattern(e,t=""){let n=re.curvePattern(e,t);this.#e(n)}async curvePatternIncrement(e,t=""){let n=re.curvePattern(e,t);return this.#t(n)}sketchPattern(e,t=""){let n=re.sketchPattern(e,t);this.#e(n)}async sketchPatternIncrement(e,t=""){let n=re.sketchPattern(e,t);return this.#t(n)}fixInstance(e){let t=re.fixInstance(e);this.#e(t)}async fixInstanceIncrement(e){let t=re.fixInstance(e);return this.#t(t)}moveInstance(e){let t=re.moveInstance(e);this.#e(t)}async moveInstanceIncrement(e){let t=re.moveInstance(e);return this.#t(t)}rotateInstance(e){let t=re.rotateInstance(e);this.#e(t)}async rotateInstanceIncrement(e){let t=re.rotateInstance(e);return this.#t(t)}mirrorInstances(e,t=""){let n=re.mirrorInstances(e,t);this.#e(n)}async mirrorInstancesIncrement(e,t=""){let n=re.mirrorInstances(e,t);return this.#t(n)}patternDrivePattern(e,t=""){let n=re.patternDrivePattern(e,t);this.#e(n)}async patternDrivePatternIncrement(e,t=""){let n=re.patternDrivePattern(e,t);return this.#t(n)}}const ce={Default:"FontName.Default",KaiTi:"FontName.KaiTi",SimHei:"FontName.SimHei",SimSun:"FontName.SimSun",FangSong:"FontName.FangSong",MicrosoftYaHei:"FontName.MicrosoftYaHei"},ae={Vertex:"ElementType.Vertex",Edge:"ElementType.Edge",Face:"ElementType.Face",Point:"ElementType.Point",Curve:"ElementType.Curve",Surface:"ElementType.Surface",Dimension:"ElementType.Dimension"},se={Angle:"VariableType.Angle",Length:"VariableType.Length",Number:"VariableType.Number"},oe={cm:"VariableUnit.cm",mm:"VariableUnit.mm",m:"VariableUnit.m",Degree:"VariableUnit.degree",Radian:"VariableUnit.radian",Number:"VariableUnit.number"};class le{static setEntityColor(e){if(e)return"Common.setEntityColor("+(e.entityId??0)+",{color:'"+(e.color??"")+"',opacity:'"+(e.opacity??"1")+"',});\n"}static setEntityVisible(e){if(e)return"Common.setEntitiesVisible("+(X(e.entityIds)??"[]")+","+(e.status??0)+");\n"}static setEntityName(e){if(e)return"Common.setEntityName("+(e.entityId??0)+",'"+(e.entityName??"")+"');\n"}static createVariable(e){if(e)return"Common.createVariable('"+e.variableName+"',{  variableValue: "+e.variableValue+",  variableType: "+(e.variableType??se.Length)+",  variableUnit: "+(e.variableUnit??oe.mm)+",  description: '"+(e.description??"")+"',});\n"}static assignVariable(e){if(e)return"Common.assignVariable('"+e.variableName+"',{  variableValue: "+e.variableValue+",  variableType: "+(e.variableType??se.Length)+",  variableUnit: "+(e.variableUnit??oe.mm)+",  description: '"+(e.description??"")+"',});\n"}static deleteVariable(e){if(e)return"Common.deleteVariable('"+e.variableName+"');\n"}static setDocAppearance(e){if(e)return"Common.setDocAppearance({\n  color: '"+(e.color??"#BBBBBB")+"',\n  opacity: "+(e.opacity??1)+",\n});\n"}static clearDocAppearance(){return"Common.clearDocAppearance();\n"}static setAppearance(e){if(e)return"Common.setAppearance({\n  ids: "+(X(e.ids)??"[]")+",\n  instanceIds: "+(X(e.instanceIds)??"[]")+",\n  color: '"+(e.color??"#BBBBBB")+"',\n  opacity: "+(e.opacity??1)+",\n});"}static clearAppearance(e){if(e)return"Common.clearAppearance({\n  ids: "+(X(e.ids)??"[]")+",\n  instanceIds: "+(X(e.instanceIds)??"[]")+",\n});\n"}static deleteEntity(e){if(e)return"Common.deleteEntity({\n  ids: "+(X(e.ids)??"[]")+",\n});\n"}static deleteFeature(e){if(e)return"Common.deleteFeature({\n  featureIds: "+(X(e.featureIds)??"[]")+",\n});\n"}}class ue{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}setEntityColor(e){let t=le.setEntityColor(e);this.#e(t)}async setEntityColorIncrement(e){let t=le.setEntityColor(e);return this.#t(t)}setEntityVisible(e){let t=le.setEntityVisible(e);this.#e(t)}async setEntityVisibleIncrement(e){let t=le.setEntityVisible(e);return this.#t(t)}setEntityName(e){let t=le.setEntityName(e);this.#e(t)}async setEntityNameIncrement(e){let t=le.setEntityName(e);return this.#t(t)}createVariable(e){let t=le.createVariable(e);this.#e(t)}async createVariableIncrement(e){let t=le.createVariable(e);return this.#t(t)}assignVariable(e){let t=le.assignVariable(e);this.#e(t)}async assignVariableIncrement(e){let t=le.assignVariable(e);return this.#t(t)}deleteVariable(e){let t=le.deleteVariable(e);this.#e(t)}async deleteVariableIncrement(e){let t=le.deleteVariable(e);return this.#t(t)}setDocAppearance(e){let t=le.setDocAppearance(e);this.#e(t)}async setDocAppearanceIncrement(e){let t=le.setDocAppearance(e);return this.#t(t)}clearDocAppearance(){let e=le.clearDocAppearance();this.#e(e)}async clearDocAppearanceIncrement(){let e=le.clearDocAppearance();return this.#t(e)}setAppearance(e){let t=le.setAppearance(e);this.#e(t)}async setAppearanceIncrement(e){let t=le.setAppearance(e);return this.#t(t)}clearAppearance(e){let t=le.clearAppearance(e);this.#e(t)}async clearAppearanceIncrement(e){let t=le.clearAppearance(e);return this.#t(t)}async deleteEntityIncrement(e){let t=le.deleteEntity(e);return this.#t(t)}async deleteFeatureIncrement(e){let t=le.deleteFeature(e);return this.#t(t)}}class pe{static createLabel(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"MBD.createLabel('"+t+"',{\n  elementId: "+(e.elementId??0)+",\n  startPoint: "+(e.startPoint?.toScript()??"new Point()")+",\n  leaderPoint: "+(X(e.leaderPoint)??"[]")+",\n  text: '"+(e.text??"")+"',\n  frameType: "+(e.frameType??1)+",\n  fontName: "+(e.fontName??ce.Default)+",\n  fontSize: "+(e.fontSize??3.5)+",\n  leaderLineType: "+(e.leaderLineType??1)+",\n  leaderLineWidth: "+(e.leaderLineWidth??0)+",\n  fontItalic: "+(e.fontItalic??0)+",\n  fontBold: "+(e.fontBold??0)+",\n  matrix: "+(n?"mat":"new Matrix4()")+",\n});\n"}}static createDatum(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"MBD.createDatum('"+t+"',{\n  elementId: "+(e.elementId??0)+",\n  startPoint: "+(e.startPoint?.toScript()??"new Point()")+",\n  leaderPoint: "+(X(e.leaderPoint)??"[]")+",\n  datumLab: '"+(e.datumLab??"")+"',\n  frameType: "+(e.frameType??1)+",\n  fontName: "+(e.fontName??ce.Default)+",\n  fontSize: "+(e.fontSize??3.5)+",\n  leaderLineType: "+(e.leaderLineType??1)+",\n  leaderLineWidth: "+(e.leaderLineWidth??0)+",\n  fontItalic: "+(e.fontItalic??0)+",\n  fontBold: "+(e.fontBold??0)+",\n  matrix: "+(n?"mat":"new Matrix4()")+",\n});\n"}}static createDatumTarget(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"MBD.createDatumTarget('"+t+"',{\n  elementId: "+(e.elementId??0)+",\n  startPoint: "+(e.startPoint?.toScript()??"new Point()")+",\n  leaderPoint: "+(X(e.leaderPoint)??"[]")+",\n  datumReference: '"+(e.datumReference??"")+"',\n  areaType: "+(e.areaType??0)+",\n  areaTxt: '"+(e.areaTxt??"")+"',\n  fontName: "+(e.fontName??ce.Default)+",\n  fontSize: "+(e.fontSize??3.5)+",\n  leaderLineType: "+(e.leaderLineType??1)+",\n  leaderLineWidth: "+(e.leaderLineWidth??0)+",\n  fontItalic: "+(e.fontItalic??0)+",\n  fontBold: "+(e.fontBold??0)+",\n  matrix: "+(n?"mat":"new Matrix4()")+",\n});\n"}}static createWeldSymbol(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"MBD.createWeldSymbol('"+t+"',{\n  elementId: "+(e.elementId??0)+",\n  pickPoint: "+(e.pickPoint?.toScript()??"new Point()")+",\n  leaderPoints: "+(X(e.leaderPoints)??"[]")+",\n  topField: "+(e.topField??!1)+",\n  peripheral: "+(e.peripheral??!1)+",\n  bottomField: "+(e.bottomField??!1)+",\n  symmetric: "+(e.symmetric??!1)+",\n  stagger: "+(e.stagger??!1)+",\n  identificationLineOnTop: "+(e.identificationLineOnTop??!1)+",\n  reference: "+(e.reference??!1)+",\n  topSecondFillet: "+(e.topSecondFillet??!1)+",\n  topSecondFilletText1: '"+(e.topSecondFilletText1??"")+"',\n  topSecondFilletText2: '"+(e.topSecondFilletText2??"")+"',\n  bottomSecondFillet: "+(e.bottomSecondFillet??!1)+",\n  bottomSecondFilletText1: '"+(e.bottomSecondFilletText1??"")+"',\n  bottomSecondFilletText2: '"+(e.bottomSecondFilletText2??"")+"',\n  topWeld: "+(e.topWeld??0)+",\n  topWeldText1: '"+(e.topWeldText1??"")+"',\n  topWeldText2: '"+(e.topWeldText2??"")+"',\n  topEdgeProfile: "+(e.topEdgeProfile??0)+",\n  bottomWeld: "+(e.bottomWeld??0)+",\n  bottomWeldText1: '"+(e.bottomWeldText1??"")+"',\n  bottomWeldText2: '"+(e.bottomWeldText2??"")+"',\n  bottomEdgeProfile: "+(e.bottomEdgeProfile??0)+",\n  topInterlacedDiscontinuitiesText: '"+(e.topInterlacedDiscontinuitiesText??"")+"',\n  bottomInterlacedDiscontinuitiesText: '"+(e.bottomInterlacedDiscontinuitiesText??"")+"',\n  tailRemarks: '"+(e.tailRemarks??"")+"',\n  fontName: "+(e.fontName??ce.Default)+",\n  fontSize: "+(e.fontSize??3.5)+",\n  leaderLineType: "+(e.leaderLineType??1)+",\n  leaderLineWidth: "+(e.leaderLineWidth??0)+",\n  fontItalic: "+(e.fontItalic??0)+",\n  fontBold: "+(e.fontBold??0)+",\n  matrix: "+(n?"mat":"new Matrix4()")+",\n});\n"}}static createSizeDimension(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"MBD.createSizeDimension('"+t+"',{\n  elementId: "+(e.elementId??0)+",\n  pickPoint: "+(e.pickPoint?.toScript()??"new Point()")+",\n  dimPosition: "+(e.dimPosition?.toScript()??"new Point()")+",\n  tolPrecisionType: "+(e.tolPrecisionType??0)+",\n  tolPrecision1: "+(e.tolPrecision1??2)+",\n  maxVariable: "+(e.maxVariable??0)+",\n  minVariable: "+(e.minVariable??0)+",\n  isReference: "+(e.isReference??0)+",\n  referenceValue: '"+(e.referenceValue??0)+"',\n  tolPrecision2: "+(e.tolPrecision2??0)+",\n  fontName: "+(e.fontName??ce.Default)+",\n  fontSize: "+(e.fontSize??3.5)+",\n  leaderLineType: "+(e.leaderLineType??1)+",\n  leaderLineWidth: "+(e.leaderLineWidth??0)+",\n  fontItalic: "+(e.fontItalic??0)+",\n  fontBold: "+(e.fontBold??0)+",\n  matrix: "+(n?"mat":"new Matrix4()")+",\n});"}}static createPositionDimension(e,t=""){if(e){let n=16===e.matrix4?.elements?.length,r="";return n&&(r="var mat = new Matrix4();\nmat.set("+e.matrix4.elements+");\n"),r+"MBD.createPositionDimension('"+t+"',{\n  firstElementId: "+(e.firstElementId??0)+",\n  firstPickPoint: "+(e.firstPickPoint?.toScript()??"new Point()")+",\n  secondElementId: "+(e.secondElementId??0)+",\n  secondPickPoint: "+(e.secondPickPoint?.toScript()??"new Point()")+",\n  dimPosition: "+(e.dimPosition?.toScript()??"new Point()")+",\n  tolPrecisionType: "+(e.tolPrecisionType??0)+",\n  tolPrecision1: "+(e.tolPrecision1??2)+",\n  maxVariable: "+(e.maxVariable??0)+",\n  minVariable: "+(e.minVariable??0)+",\n  isReference: "+(e.isReference??0)+",\n  referenceValue: '"+(e.referenceValue??0)+"',\n  tolPrecision2: "+(e.tolPrecision2??0)+",\n  fontName: "+(e.fontName??ce.Default)+",\n  fontSize: "+(e.fontSize??3.5)+",\n  leaderLineType: "+(e.leaderLineType??1)+",\n  leaderLineWidth: "+(e.leaderLineWidth??0)+",\n  fontItalic: "+(e.fontItalic??0)+",\n  fontBold: "+(e.fontBold??0)+",\n  matrix: "+(n?"mat":"new Matrix4()")+",\n});"}}}class me{constructor(e){this.parent=e}#e(e){e&&(this.parent.commandScript+=e)}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}createLabel(e,t=""){let n=pe.createLabel(e,t);this.#e(n)}async createLabelIncrement(e,t=""){let n=pe.createLabel(e,t);return this.#t(n)}createDatum(e,t=""){let n=pe.createDatum(e,t);this.#e(n)}async createDatumIncrement(e,t=""){let n=pe.createDatum(e,t);return this.#t(n)}createDatumTarget(e,t=""){let n=pe.createDatumTarget(e,t);this.#e(n)}async createDatumTargetIncrement(e,t=""){let n=pe.createDatumTarget(e,t);return this.#t(n)}createWeldSymbol(e,t=""){let n=pe.createWeldSymbol(e,t);this.#e(n)}async createWeldSymbolIncrement(e,t=""){let n=pe.createWeldSymbol(e,t);return this.#t(n)}createSizeDimension(e,t=""){let n=pe.createSizeDimension(e,t);this.#e(n)}async createSizeDimensionIncrement(e,t=""){let n=pe.createSizeDimension(e,t);return this.#t(n)}createPositionDimension(e,t=""){let n=pe.createPositionDimension(e,t);this.#e(n)}async createPositionDimensionIncrement(e,t=""){let n=pe.createPositionDimension(e,t);return this.#t(n)}}class de{static getElementIdsByElementType(e){if(e)return"Query.getElementIdsByElementType("+(e.entityId??0)+","+(e.elementType??ae.Edge)+",'"+(e.instanceId??"")+"');\n"}static getElementIdsByVertexId(e){if(e)return"Query.getElementIdsByVertexId("+(e.entityId??0)+","+(e.vertexId??0)+","+(e.elementType??ae.Face)+",'"+(e.instanceId??"")+"');\n"}static getBoundedFaceIdsByFaceOrEdge(e){if(e)return"Query.getBoundedFaceIdsByFaceOrEdge("+(e.elementId??0)+",'"+(e.instanceId??"")+"');\n"}static getPointNormalOnFace(e){if(e)return"Query.getPointNormalOnFace("+(e.point?.toScript()??"new Point()")+","+(e.elementId??0)+",'"+(e.instanceId??"")+"');\n"}}class Se{constructor(e){this.parent=e}async#t(e,t=q,n={}){return this.parent.executeIncrementCommand(e,t,n)}async getElementIdsByElementTypeIncrement(e){let t=de.getElementIdsByElementType(e);return this.#t(t)}async getElementIdsByVertexIdIncrement(e){let t=de.getElementIdsByVertexId(e);return this.#t(t)}async getBoundedFaceIdsByFaceOrEdgeIncrement(e){let t=de.getBoundedFaceIdsByFaceOrEdge(e);return this.#t(t)}async getPointNormalOnFaceIncrement(e){let t=de.getPointNormalOnFace(e);return this.#t(t)}}class he{constructor(e){this.parent=e,this.commandScript="",this.sketch=new G(this),this.solid=new U(this),this.curve=new K(this),this.datum=new J(this),this.evaluate=new ee(this),this.surface=new ne(this),this.assembly=new ie(this),this.common=new ue(this),this.mbd=new me(this),this.query=new Se(this)}clearCommand(){this.commandScript=""}getCommandScript(){return this.commandScript}async execute(e=!1,t=""){return new Promise(((n,r)=>{let i=s,c=Math.floor(16777216*Math.random());this.parent.messageList.push({key:c,name:i,resolve:n,reject:r}),window.parent.postMessage({type:s,value:{key:c,script:""===t?this.commandScript:t,overwrite:e}},this.parent.parentOrigin)}))}async executeIncrementCommand(e="",t,n={}){return new Promise(((r,i)=>{let c=o,a=Math.floor(16777216*Math.random());this.parent.messageList.push({key:a,name:c,resolve:r,reject:i}),window.parent.postMessage({type:o,value:{key:a,script:e,commandType:t,params:n}},this.parent.parentOrigin)}))}async executeInSpecifiedDoc(e,t,n,r=!1,i=""){return new Promise(((c,a)=>{let s=l,o=Math.floor(16777216*Math.random());this.parent.messageList.push({key:o,name:s,resolve:c,reject:a}),window.parent.postMessage({type:l,value:{key:o,script:""===i?this.commandScript:i,overwrite:r,projectId:e,documentId:t,versionId:n}},this.parent.parentOrigin)}))}async createDocument(e,t,n,r,i){return await this.parent.request.execFunction(F,{projectId:e,folderCode:t,docName:n,documentType:r,template:i})}}class ye{constructor(e){this.parent=e}subscribeEvent(e,t){let r=Math.floor(16777216*Math.random());return this.parent.messageList.push({key:r,name:e,callback:t}),window.parent.postMessage({type:n,value:{key:r,eventName:e}},this.parent.parentOrigin),r}unSubscribeEvent(e,t){this.parent.messageList.filter((n=>n.name===e&&n.key===t)).forEach((e=>{this.parent.messageList.splice(this.parent.messageList.indexOf(e),1)})),window.parent.postMessage({type:r,value:{subscribeId:t,eventName:e}},this.parent.parentOrigin)}async execFunction(e,t){return new Promise(((n,r)=>{let i=Math.floor(16777216*Math.random());this.parent.messageList.push({key:i,name:e,params:t,resolve:n,reject:r}),window.parent.postMessage({type:a,value:{key:i,functionName:e,params:t}},this.parent.parentOrigin)}))}}class Ie{constructor(e){this.parent=e}async getElementsByIds(e){return this.parent.request.execFunction(u,{elementIds:e})}async getElementsByFeatureId(e){return this.parent.request.execFunction(p,{featureId:e})}async getElementsByEntityId(e){return this.parent.request.execFunction(m,{entityId:e})}async getEntitiesByIds(e){return this.parent.request.execFunction(y,{entityIds:e})}async getEntities(){return this.parent.request.execFunction(I,{})}async getEntitiesByFeatureIds(e){return this.parent.request.execFunction(f,{featureIds:e})}async getFeatures(e){return this.parent.request.execFunction(v,{featureIds:e})}async getFeaturesByNames(e){return this.parent.request.execFunction(C,{featureNames:e})}async getInstancesByIds(e){return this.parent.request.execFunction(T,{instanceIds:e})}async getTopInstance(e){return this.parent.request.execFunction(w,{instanceId:e})}async getElementInAssembly(e,t){return this.parent.request.execFunction(d,{instanceId:e,elementId:t})}async getEntityInAssembly(e,t){return this.parent.request.execFunction(g,{instanceId:e,entityId:t})}async getEntitiesByInstanceId(e){return this.parent.request.execFunction(x,{instanceId:e})}async getElementsByInstanceId(e){return this.parent.request.execFunction(S,{instanceId:e})}async getEntitiesByFeatureNames(e){return this.parent.request.execFunction(P,{featureNames:e})}async getElementsByFeatureNames(e){return this.parent.request.execFunction(h,{featureNames:e})}async getInstanceTree(){return this.parent.request.execFunction(B,{})}}class fe{constructor(e){this.parent=e}subscribeElementPickEvent(e){return this.parent.request.subscribeEvent(R,e)}unSubscribeElementPickEvent(e){this.parent.request.unSubscribeEvent(R,e)}subscribeFeaturePickEvent(e){return this.parent.request.subscribeEvent(N,e)}unSubscribeFeaturePickEvent(e){this.parent.request.unSubscribeEvent(N,e)}messageTip(e){this.parent.request.execFunction(k,e)}async addHeightElement(e){return this.parent.request.execFunction(E,{ids:e})}async removeHeightElement(e){return this.parent.request.execFunction(b,{ids:e})}async clearPreview(){return this.parent.request.execFunction(D,{})}async clearSelection(){return this.parent.request.execFunction(A,{})}}e.Axis=class{constructor(){return this.lineId=null,this.instanceId=null,this.point1=null,this.point2=null,this}setLineId(e){return this.lineId=e,this}setInstanceId(e){return this.instanceId=e,this}setPoint(e,t){return this.point1=e,this.point2=t,this}toScript(){return null!==this.point1&&null!==this.point2?"new Axis("+this.point1.toScript()+","+this.point2.toScript()+")":null!==this.lineId&&null===this.instanceId?"new Axis("+this.lineId+")":this.lineId&&this.instanceId?"new Axis("+this.lineId+",'"+this.instanceId+"')":"new Axis()"}},e.ConstraintType=j,e.CrownCADPlugin=class{constructor(){this.maxAttemptNumber=5,this.parentOrigin="https://cad.crowncad.com/",this.command=null,this.query=null,this.event=null,this.messageList=[]}setParentOrigin(e){this.parentOrigin=e}setMaxAttempt(e){this.maxAttemptNumber=e}setLayout(e,t,n){this.layout={maxWidth:e,minWidth:t,maxHeight:n}}async connect(){let e,n=0;return new Promise(((r,a)=>{const s=n=>{if(n.origin===this.parentOrigin){if(n.data.type===t){clearInterval(e),window.removeEventListener("message",s,!1),this.parentOrigin=n.origin,this.request=new ye(this),this.command=new he(this),this.query=new Ie(this),this.event=new fe(this),this.listener=e=>{if(e.data.type===i){const t=e.data.key;e.data.name;const n=e.data.response.code,r=e.data.response.data;this.messageList.filter((e=>e.key===t)).forEach((e=>{e?.resolve?(e.resolve({code:n,data:r}),this.messageList.splice(this.messageList.indexOf(e),1)):e?.callback&&e.callback(r)}))}else e.data.type===c&&this.destroyed()},window.addEventListener("message",this.listener,!1);let t=n.data.initInfo;return r(t)}return a("Failed handshake")}};window.addEventListener("message",s,!1);const o=()=>{if(n++,window.parent.postMessage({type:t,value:{layout:this.layout}},this.parentOrigin),n===this.maxAttemptNumber)return clearInterval(e),a("Failed handshake")};o(),e=setInterval(o,500)}))}destroyed(){window.removeEventListener("message",this.listener,!1),this.listener=null,this.parentOrigin="https://cad.crowncad.com/",this.command=null,this.request=null,this.query=null,this.event=null,this.messageList=[]}},e.DefaultTemplate={GB_PART:"GB_PART",GB_ASSEMBLY:"GB_ASSEMBLY",GB_A0:"GB_A0",GB_A1:"GB_A1",GB_A2:"GB_A2",GB_A3:"GB_A3",GB_A4:"GB_A4",GB_A4_PORTRAIT:"GB_A4_Portrait"},e.Direction=class{constructor(){return this.lineId=null,this.instanceId=null,this.point1=null,this.point2=null,this}setLineId(e){return this.lineId=e,this}setInstanceId(e){return this.instanceId=e,this}setPoint(e,t){return this.point1=e,this.point2=t,this}toScript(){return null!==this.point1&&null!==this.point2?"new Direction("+this.point1.toScript()+","+this.point2.toScript()+")":null!==this.lineId&&null===this.instanceId?"new Direction("+this.lineId+")":this.lineId&&this.instanceId?"new Direction("+this.lineId+",'"+this.instanceId+"')":"new Direction()"}},e.DocumentType={PART:"PartDocument",ASSEMBLY:"AssemblyDocument",DRAWING3D:"Drawing3dDocument",FOLDER:"FolderDocument"},e.Matrix4=z,e.Point=W,e.ScriptElementType=ae,e.ScriptFontNameType=ce,e.ScriptVariableType=se,e.ScriptVariableUnit=oe,Object.defineProperty(e,"__esModule",{value:!0})}));
